import VShowAndVModelDemo from '@/components/mdx/constituents/vue/vueVShow.jsx'
import VLazyDemo from '@/components/mdx/constituents/vue/vueDirectiveVLazy/index.jsx'
import VThrottleDemo from '@/components/mdx/constituents/vue/vueDirectiveVThrottle.jsx'

# vue directives

* `jsx`ÁîüËèúÔºöËÆ∞ÂΩïÂÖ≥‰∫é‰ΩøÁî®`esbuild`ÁºñËØë`vue`+`jsx`Êó∂ÊâÄÁî®Âà∞ÁöÑ‰∏Ä‰∫õÁ°¨Ê†∏ÔºàÁîüÁ°¨ÔºâÁöÑÊäÄÂ∑ßüêõü¶ã

  ## ÂéüÁîüÊåá‰ª§

  * `v-show`Âíå`v-model`Ôºö`jsx`‰∏≠`v-model`‰∏ÄËà¨ÈúÄË¶ÅÊãÜÂàÜÊàê`value={ value } onXXX={ actionToValue }`Ôºå`v-show`ÂàôÈúÄË¶ÅÈÄö
  Ëøá`vue`Êèê‰æõÁöÑÊé•Âè£`withDirectives`Êù•ÊâãÂä®ÂÆûÁé∞ÔºõÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºå‰ªª‰ΩïËá™ÂÆö‰πâÁöÑÊåá‰ª§ÈÉΩÈúÄË¶ÅÈÄöËøáËøôÁßçÊñπÂºèÊù•ÂÆûÁé∞ÔºåÈô§ÈùûÈõÜÊàêÁ±ª‰ºº
  `esbuild-plugin-vue`ËøôÊ†∑ÁöÑÊèí‰ª∂Êù•‰ΩøÁî®`vue`ÁöÑÊ®°ÊùøËØ≠Ê≥ï
    ```javascript
    import {
      defineComponent,
      withDirectives,
      ref,
      vShow
    } from 'vue'
    import { ElSwitch } from 'element-plus/components'

    defineComponent({
      name: 'Test',
      components: { ElSwitch },
      setup() {
        const show = ref(true)
        const toggle = () => show.value = !show.value

        return () => {
          return <>
            <ElSwitch modelValue={ show.value } onChange={ toggle }></ElSwitch>
            {
              withDirectives(<span>üôà</span>, [[vShow, show.value]])
            }
          </>
        }
      }
    })
    ```

    ### `Demo`: { <VShowAndVModelDemo></VShowAndVModelDemo> }

  ## Ëá™ÂÆö‰πâÊåá‰ª§

  * Ëá™ÂÆö‰πâÂõæÁâáÊáíÂä†ËΩΩÊåá‰ª§`v-lazy`Ôºö
    ```javascript
    import { defineComponent, withDirectives } from 'vue'
    import styles from '@/components/mdx/constituents/vue/vueDirectiveVLazy/index.module.css'
    import catGirlImg from '@/assets/images/catgirl.jpg'
    import defaultImg from '@/assets/images/nopic.svg'

    export default defineComponent({
      name: 'LazyPicture',
      setup() {
        const data = {
          'http://example.com/catgirl.jpg': catGirlImg
        }

        const VLazy = {
          beforeMount(el, binding) {
            el.dataset.src = el.src
            el.src = defaultImg
          },
          mounted(el, binding) {
            const lazy = binding.value

            if(lazy) {
              // ËøôÈáåÊúâ‰∏™Â§ßÂùë„ÄÇ„ÄÇ„ÄÇ
              // IntersectionObserverÁöÑÂõûË∞É‰ºöÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÊâßË°å‰∏ÄÊ¨°Ôºå
              // ÊâÄ‰ª•Âä°ÂøÖÂÅöÂ•ΩÂØπentry.intersectionRatioÂíåentry.isIntersectingÁöÑÂà§Êñ≠
              let timer = null
              const observer = new IntersectionObserver(([entry]) => {
                if(entry.intersectionRatio > 0.0 && !timer) {
                  // Ê®°ÊãüÂºÇÊ≠•Êï∞ÊçÆËØ∑Ê±Ç
                  timer = setTimeout(() => {
                    entry.target.src = data[entry.target.dataset.src]
                    if(entry.isIntersecting) {
                      entry.target.removeAttribute('data-src')
                      observer.unobserve(entry.target)
                    }
                    timer = null
                  }, 1000)
                }
              }, {
                rootMargin: '0px 0px 0px 0px',
                threshold: 0.0
              })

              observer.observe(el)
            }
          }
        }

        return () => {
          return <>
            <div class={ styles('content') }>
              {
                withDirectives(
                  <img src="http://example.com/catgirl.jpg" class={ styles('cat-girl') }></img>,
                  [[VLazy, true]]
                )
              }
            </div>
          </>
        }
      }
    })
    ```
    ```css
    .content {
      display: flex;
      justify-content: left;
    }

    .cat-girl {
      width: 275px;
      border-radius: 11px;
    }
    ```

    ### `Demo`: { <VLazyDemo></VLazyDemo> }
  
  * Ëá™ÂÆö‰πâËäÇÊµÅÊåá‰ª§`v-throttle`Ôºö
    ```javascript
    import { defineComponent, withDirectives } from "vue"
    import { ElButton, ElMessage } from 'element-plus/components'

    export default defineComponent({
      name: 'ThrottleButton',
      components: { ElButton },
      setup() {
        const styleDict = { 'vertical-align': 'text-bottom' }

        const onSubmit = () => {
          ElMessage({
            message: 'Done!',
            type: 'success'
          })
        }

        const VThrottle = {
          mounted(el, binding) {
            const interval = typeof binding.value === 'number' ? binding.value : 1500

            let timer = null
            el.addEventListener(
              'click',
              (ev) => {
                if(!timer) {
                  timer = setTimeout(() => {
                    timer = null
                  }, interval)
                } else {
                  ev && ev.stopImmediatePropagation()
                }
              },
              true
            )
          }
        }

        return () => {
          return <>
            {
              withDirectives(
                <ElButton
                  style={ styleDict }
                  type="primary"
                  plain size="small"
                  onClick={ onSubmit }
                >
                  Êèê‰∫§
                </ElButton>,
                [[VThrottle, true]]
              )
            }
          </>
        }
      }
    })
    ```
    ### `Demo` { <VThrottleDemo></VThrottleDemo> }