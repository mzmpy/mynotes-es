import{a as C0,b as E0}from"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-M6JLTZ7S.js";import{$ as z0,A as X0,Aa as Y1,B as V,Ba as Z1,C as T0,D as D1,F as m0,Fa as V0,G as j0,H as E,I as z,J as e0,K as u0,L as k,M as t0,N as B,P as n0,R as O0,S as B1,T as v0,U as A0,V as g0,W as U0,X as G0,Y as W1,Z as F1,_ as k1,aa as H1,ba as i0,c as y0,ca as X1,da as p0,e as J,ea as j1,f as S,fa as K,g as R1,ga as r0,h as L1,i as Q,ia as K0,j as S1,ja as D,k as I1,ka as H,l as B0,la as U1,m as N1,ma as q0,n as W0,na as Y0,o as M1,oa as Z0,p as F0,pa as G1,q as P1,qa as x0,r as b0,ra as z1,s as c0,sa as s0,t as I,ta as q,u as P,ua as X,va as w0,w as _0,wa as K1,x as $,xa as q1,y as k0,ya as o0,z as H0,za as j}from"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-TD4TYOPQ.js";import"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-5QVKP7EZ.js";import{a as D0}from"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-KLQSSXLF.js";import{J as Z,N as h0,_ as L,d as O,e as x,na as C,va as P0,x as F,y as d0}from"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-RMEIYZWT.js";x();P0();x();x();x();P0();x();var l2={"gl-canvas":{name:"src__components__mdx__constituents__threejs__use-obj-and-gltf__windmill__index-DiiN-q-gl-canvas",composes:[],isReferenced:!1}},J1=(u=>e=>{if(typeof e!="string")throw new TypeError("resolveStyles: parameter 'className' must be a string.");return u[e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase())].name})(l2);x();var d2=/^[og]\s*(.+)?/,h2=/^mtllib /,y2=/^usemtl /,b2=/^usemap /,Q1=/\s+/,$1=new V,J0=new V,e2=new V,t2=new V,N=new V,R0=new E;function _2(){let u={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}let i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(n,v){let r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);let o={index:this.materials.length,name:n||"",mtllib:Array.isArray(v)&&v.length>0?v[v.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(s){let f={index:typeof s=="number"?s:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return f.clone=this.clone.bind(f),f}};return this.materials.push(o),o},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(n){let v=this.currentMaterial();if(v&&v.groupEnd===-1&&(v.groupEnd=this.geometry.vertices.length/3,v.groupCount=v.groupEnd-v.groupStart,v.inherited=!1),n&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return n&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),v}},i&&i.name&&typeof i.clone=="function"){let n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){let i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseNormalIndex:function(e,t){let i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseUVIndex:function(e,t){let i=parseInt(e,10);return(i>=0?i-1:i+t/2)*2},addVertex:function(e,t,i){let n=this.vertices,v=this.object.geometry.vertices;v.push(n[e+0],n[e+1],n[e+2]),v.push(n[t+0],n[t+1],n[t+2]),v.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){let n=this.normals,v=this.object.geometry.normals;v.push(n[e+0],n[e+1],n[e+2]),v.push(n[t+0],n[t+1],n[t+2]),v.push(n[i+0],n[i+1],n[i+2])},addFaceNormal:function(e,t,i){let n=this.vertices,v=this.object.geometry.normals;$1.fromArray(n,e),J0.fromArray(n,t),e2.fromArray(n,i),N.subVectors(e2,J0),t2.subVectors($1,J0),N.cross(t2),N.normalize(),v.push(N.x,N.y,N.z),v.push(N.x,N.y,N.z),v.push(N.x,N.y,N.z)},addColor:function(e,t,i){let n=this.colors,v=this.object.geometry.colors;n[e]!==void 0&&v.push(n[e+0],n[e+1],n[e+2]),n[t]!==void 0&&v.push(n[t+0],n[t+1],n[t+2]),n[i]!==void 0&&v.push(n[i+0],n[i+1],n[i+2])},addUV:function(e,t,i){let n=this.uvs,v=this.object.geometry.uvs;v.push(n[e+0],n[e+1]),v.push(n[t+0],n[t+1]),v.push(n[i+0],n[i+1])},addDefaultUV:function(){let e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){let t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,n,v,r,o,s,f){let c=this.vertices.length,a=this.parseVertexIndex(e,c),m=this.parseVertexIndex(t,c),p=this.parseVertexIndex(i,c);if(this.addVertex(a,m,p),this.addColor(a,m,p),o!==void 0&&o!==""){let d=this.normals.length;a=this.parseNormalIndex(o,d),m=this.parseNormalIndex(s,d),p=this.parseNormalIndex(f,d),this.addNormal(a,m,p)}else this.addFaceNormal(a,m,p);if(n!==void 0&&n!==""){let d=this.uvs.length;a=this.parseUVIndex(n,d),m=this.parseUVIndex(v,d),p=this.parseUVIndex(r,d),this.addUV(a,m,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";let t=this.vertices.length;for(let i=0,n=e.length;i<n;i++){let v=this.parseVertexIndex(e[i],t);this.addVertexPoint(v),this.addColor(v)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";let i=this.vertices.length,n=this.uvs.length;for(let v=0,r=e.length;v<r;v++)this.addVertexLine(this.parseVertexIndex(e[v],i));for(let v=0,r=t.length;v<r;v++)this.addUVLine(this.parseUVIndex(t[v],n))}};return u.startObject("",!1),u}var L0=class extends s0{constructor(e){super(e),this.materials=null}load(e,t,i,n){let v=this,r=new q(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(o){try{t(v.parse(o))}catch(s){n?n(s):console.error(s),v.manager.itemError(e)}},i,n)}setMaterials(e){return this.materials=e,this}parse(e){let t=new _2;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));let i=e.split(`
`),n=[];for(let o=0,s=i.length;o<s;o++){let f=i[o].trimStart();if(f.length===0)continue;let c=f.charAt(0);if(c!=="#")if(c==="v"){let a=f.split(Q1);switch(a[0]){case"v":t.vertices.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3])),a.length>=7?(R0.setRGB(parseFloat(a[4]),parseFloat(a[5]),parseFloat(a[6])).convertSRGBToLinear(),t.colors.push(R0.r,R0.g,R0.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));break;case"vt":t.uvs.push(parseFloat(a[1]),parseFloat(a[2]));break}}else if(c==="f"){let m=f.slice(1).trim().split(Q1),p=[];for(let h=0,l=m.length;h<l;h++){let y=m[h];if(y.length>0){let b=y.split("/");p.push(b)}}let d=p[0];for(let h=1,l=p.length-1;h<l;h++){let y=p[h],b=p[h+1];t.addFace(d[0],y[0],b[0],d[1],y[1],b[1],d[2],y[2],b[2])}}else if(c==="l"){let a=f.substring(1).trim().split(" "),m=[],p=[];if(f.indexOf("/")===-1)m=a;else for(let d=0,h=a.length;d<h;d++){let l=a[d].split("/");l[0]!==""&&m.push(l[0]),l[1]!==""&&p.push(l[1])}t.addLineGeometry(m,p)}else if(c==="p"){let m=f.slice(1).trim().split(" ");t.addPointGeometry(m)}else if((n=d2.exec(f))!==null){let a=(" "+n[0].slice(1).trim()).slice(1);t.startObject(a)}else if(y2.test(f))t.object.startMaterial(f.substring(7).trim(),t.materialLibraries);else if(h2.test(f))t.materialLibraries.push(f.substring(7).trim());else if(b2.test(f))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(c==="s"){if(n=f.split(" "),n.length>1){let m=n[1].trim().toLowerCase();t.object.smooth=m!=="0"&&m!=="off"}else t.object.smooth=!0;let a=t.object.currentMaterial();a&&(a.smooth=t.object.smooth)}else{if(f==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+f+'"')}}t.finalize();let v=new v0;if(v.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let o=0,s=t.objects.length;o<s;o++){let f=t.objects[o],c=f.geometry,a=f.materials,m=c.type==="Line",p=c.type==="Points",d=!1;if(c.vertices.length===0)continue;let h=new t0;h.setAttribute("position",new k(c.vertices,3)),c.normals.length>0&&h.setAttribute("normal",new k(c.normals,3)),c.colors.length>0&&(d=!0,h.setAttribute("color",new k(c.colors,3))),c.hasUVIndices===!0&&h.setAttribute("uv",new k(c.uvs,2));let l=[];for(let b=0,g=a.length;b<g;b++){let _=a[b],R=_.name+"_"+_.smooth+"_"+d,A=t.materials[R];if(this.materials!==null){if(A=this.materials.create(_.name),m&&A&&!(A instanceof i0)){let w=new i0;z.prototype.copy.call(w,A),w.color.copy(A.color),A=w}else if(p&&A&&!(A instanceof K)){let w=new K({size:10,sizeAttenuation:!1});z.prototype.copy.call(w,A),w.color.copy(A.color),w.map=A.map,A=w}}A===void 0&&(m?A=new i0:p?A=new K({size:1,sizeAttenuation:!1}):A=new H,A.name=_.name,A.flatShading=!_.smooth,A.vertexColors=d,t.materials[R]=A),l.push(A)}let y;if(l.length>1){for(let b=0,g=a.length;b<g;b++){let _=a[b];h.addGroup(_.groupStart,_.groupCount,b)}m?y=new p0(h,l):p?y=new r0(h,l):y=new B(h,l)}else m?y=new p0(h,l[0]):p?y=new r0(h,l[0]):y=new B(h,l[0]);y.name=f.name,v.add(y)}else if(t.vertices.length>0){let o=new K({size:1,sizeAttenuation:!1}),s=new t0;s.setAttribute("position",new k(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(s.setAttribute("color",new k(t.colors,3)),o.vertexColors=!0);let f=new r0(s,o);v.add(f)}return v}};x();var S0=class extends s0{constructor(e){super(e)}load(e,t,i,n){let v=this,r=this.path===""?j.extractUrlBase(e):this.path,o=new q(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(s){try{t(v.parse(s,r))}catch(f){n?n(f):console.error(f),v.manager.itemError(e)}},i,n)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){let i=e.split(`
`),n={},v=/\s+/,r={};for(let s=0;s<i.length;s++){let f=i[s];if(f=f.trim(),f.length===0||f.charAt(0)==="#")continue;let c=f.indexOf(" "),a=c>=0?f.substring(0,c):f;a=a.toLowerCase();let m=c>=0?f.substring(c+1):"";if(m=m.trim(),a==="newmtl")n={name:m},r[m]=n;else if(a==="ka"||a==="kd"||a==="ks"||a==="ke"){let p=m.split(v,3);n[a]=[parseFloat(p[0]),parseFloat(p[1]),parseFloat(p[2])]}else n[a]=m}let o=new Q0(this.resourcePath||t,this.materialOptions);return o.setCrossOrigin(this.crossOrigin),o.setManager(this.manager),o.setMaterials(r),o}},Q0=class{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:y0,this.wrap=this.options.wrap!==void 0?this.options.wrap:S}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;let t={};for(let i in e){let n=e[i],v={};t[i]=v;for(let r in n){let o=!0,s=n[r],f=r.toLowerCase();switch(f){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&s[0]===0&&s[1]===0&&s[2]===0&&(o=!1);break;default:break}o&&(v[f]=s)}}return t}preload(){for(let e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(let t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){let t=this,i=this.materialsInfo[e],n={name:e,side:this.side};function v(o,s){return typeof s!="string"||s===""?"":/^https?:\/\//i.test(s)?s:o+s}function r(o,s){if(n[o])return;let f=t.getTextureParams(s,n),c=t.loadTexture(v(t.baseUrl,f.url));c.repeat.copy(f.scale),c.offset.copy(f.offset),c.wrapS=t.wrap,c.wrapT=t.wrap,(o==="map"||o==="emissiveMap")&&(c.colorSpace=I),n[o]=c}for(let o in i){let s=i[o],f;if(s!=="")switch(o.toLowerCase()){case"kd":n.color=new E().fromArray(s).convertSRGBToLinear();break;case"ks":n.specular=new E().fromArray(s).convertSRGBToLinear();break;case"ke":n.emissive=new E().fromArray(s).convertSRGBToLinear();break;case"map_kd":r("map",s);break;case"map_ks":r("specularMap",s);break;case"map_ke":r("emissiveMap",s);break;case"norm":r("normalMap",s);break;case"map_bump":case"bump":r("bumpMap",s);break;case"map_d":r("alphaMap",s),n.transparent=!0;break;case"ns":n.shininess=parseFloat(s);break;case"d":f=parseFloat(s),f<1&&(n.opacity=f,n.transparent=!0);break;case"tr":f=parseFloat(s),this.options&&this.options.invertTrProperty&&(f=1-f),f>0&&(n.opacity=1-f,n.transparent=!0);break;default:break}}return this.materials[e]=new H(n),this.materials[e]}getTextureParams(e,t){let i={scale:new $(1,1),offset:new $(0,0)},n=e.split(/\s+/),v;return v=n.indexOf("-bm"),v>=0&&(t.bumpScale=parseFloat(n[v+1]),n.splice(v,2)),v=n.indexOf("-s"),v>=0&&(i.scale.set(parseFloat(n[v+1]),parseFloat(n[v+2])),n.splice(v,4)),v=n.indexOf("-o"),v>=0&&(i.offset.set(parseFloat(n[v+1]),parseFloat(n[v+2])),n.splice(v,4)),i.url=n.join(" ").trim(),i}loadTexture(e,t,i,n,v){let r=this.manager!==void 0?this.manager:z1,o=r.getHandler(e);o===null&&(o=new X(r)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin);let s=o.load(e,i,n,v);return t!==void 0&&(s.mapping=t),s}};var n2="https://mzmpy.github.io/mynotes-es/assets/obj/windmill_001-XQOMCDYN.obj";var v2="https://mzmpy.github.io/mynotes-es/assets/mtl/windmill_001-RVADYG7F.mtl";var i2=Z({name:"ThreeJsWindmill",setup(){let u=F(),e=d0(),t=F(0),i=F(""),n=new x0,v=new g0,r=new n0(45,3/2,.1,500),o=new o0(16777215,2.5),s=new w0(11657727,12155424,2);r.position.set(0,10,35),o.position.set(0,10,0),o.target.position.set(-5,0,0),o.castShadow=!0,h0(()=>{let a=new O0(40,40);new X(n).load(E0,h=>{h.colorSpace=I,h.wrapS=S,h.wrapT=S,h.magFilter=Q,h.repeat.set(40/2,40/2);let l=new H({map:h,side:J}),y=new B(a,l);y.rotation.x=-.5*Math.PI,y.receiveShadow=!0,v.add(y)}),new S0(n).load(v2,h=>{h.preload();let l=new L0(n);l.setMaterials(h),l.load(n2,y=>{v.add(y)})}),n.onProgress=(h,l,y)=>{let b=Math.round(l/y*100);console.log(`loaded ${b}%`,h),i.value="\u6B63\u5728\u52A0\u8F7D\u8D44\u6E90...",t.value=b},e.value=new A0({antialias:!0,canvas:u.value}),e.value.shadowMap.enabled=!0,e.value.setPixelRatio(10),v.add(s,o),v.background=new E(0);let d=new C0(r,u.value);d.target.set(0,5,0),d.update(),requestAnimationFrame(f)});let f=()=>{e.value.render(v,r),requestAnimationFrame(f)};return()=>C(L,null,C(V0,{showAnimation:!1,progress:t.value,progressTitle:i.value},{canvas:()=>C("canvas",{class:J1("gl-canvas"),ref:u})}))}});x();P0();x();var g2={"gl-canvas":{name:"src__components__mdx__constituents__threejs__use-obj-and-gltf__smallCity__index-GDTK7G-gl-canvas",composes:[],isReferenced:!1}},r2=(u=>e=>{if(typeof e!="string")throw new TypeError("resolveStyles: parameter 'className' must be a string.");return u[e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase())].name})(g2);x();x();function $0(u,e){if(e===P1)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),u;if(e===c0||e===b0){let t=u.getIndex();if(t===null){let r=[],o=u.getAttribute("position");if(o!==void 0){for(let s=0;s<o.count;s++)r.push(s);u.setIndex(r),t=u.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),u}let i=t.count-2,n=[];if(e===c0)for(let r=1;r<=i;r++)n.push(t.getX(0)),n.push(t.getX(r)),n.push(t.getX(r+1));else for(let r=0;r<i;r++)r%2===0?(n.push(t.getX(r)),n.push(t.getX(r+1)),n.push(t.getX(r+2))):(n.push(t.getX(r+2)),n.push(t.getX(r+1)),n.push(t.getX(r)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let v=u.clone();return v.setIndex(n),v.clearGroups(),v}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),u}var I0=class extends s0{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new s1(t)}),this.register(function(t){return new d1(t)}),this.register(function(t){return new h1(t)}),this.register(function(t){return new y1(t)}),this.register(function(t){return new f1(t)}),this.register(function(t){return new a1(t)}),this.register(function(t){return new c1(t)}),this.register(function(t){return new m1(t)}),this.register(function(t){return new r1(t)}),this.register(function(t){return new u1(t)}),this.register(function(t){return new o1(t)}),this.register(function(t){return new l1(t)}),this.register(function(t){return new p1(t)}),this.register(function(t){return new v1(t)}),this.register(function(t){return new b1(t)}),this.register(function(t){return new _1(t)})}load(e,t,i,n){let v=this,r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){let f=j.extractUrlBase(e);r=j.resolveURL(f,this.path)}else r=j.extractUrlBase(e);this.manager.itemStart(e);let o=function(f){n?n(f):console.error(f),v.manager.itemError(e),v.manager.itemEnd(e)},s=new q(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(f){try{v.parse(f,r,function(c){t(c),v.manager.itemEnd(e)},o)}catch(c){o(c)}},i,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let v,r={},o={},s=new TextDecoder;if(typeof e=="string")v=JSON.parse(e);else if(e instanceof ArrayBuffer)if(s.decode(new Uint8Array(e,0,4))===c2){try{r[T.KHR_BINARY_GLTF]=new T1(e)}catch(a){n&&n(a);return}v=JSON.parse(r[T.KHR_BINARY_GLTF].content)}else v=JSON.parse(s.decode(e));else v=e;if(v.asset===void 0||v.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let f=new C1(v,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){let a=this.pluginCallbacks[c](f);a.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[a.name]=a,r[a.name]=!0}if(v.extensionsUsed)for(let c=0;c<v.extensionsUsed.length;++c){let a=v.extensionsUsed[c],m=v.extensionsRequired||[];switch(a){case T.KHR_MATERIALS_UNLIT:r[a]=new i1;break;case T.KHR_DRACO_MESH_COMPRESSION:r[a]=new O1(v,this.dracoLoader);break;case T.KHR_TEXTURE_TRANSFORM:r[a]=new A1;break;case T.KHR_MESH_QUANTIZATION:r[a]=new g1;break;default:m.indexOf(a)>=0&&o[a]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+a+'".')}}f.setExtensions(r),f.setPlugins(o),f.parse(i,n)}parseAsync(e,t){let i=this;return new Promise(function(n,v){i.parse(e,t,n,v)})}};function x2(){let u={};return{get:function(e){return u[e]},add:function(e,t){u[e]=t},remove:function(e){delete u[e]},removeAll:function(){u={}}}}var T={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},v1=class{constructor(e){this.parser=e,this.name=T.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let i=0,n=t.length;i<n;i++){let v=t[i];v.extensions&&v.extensions[this.name]&&v.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,v.extensions[this.name].light)}}_loadLight(e){let t=this.parser,i="light:"+e,n=t.cache.get(i);if(n)return n;let v=t.json,s=((v.extensions&&v.extensions[this.name]||{}).lights||[])[e],f,c=new E(16777215);s.color!==void 0&&c.setRGB(s.color[0],s.color[1],s.color[2],P);let a=s.range!==void 0?s.range:0;switch(s.type){case"directional":f=new o0(c),f.target.position.set(0,0,-1),f.add(f.target);break;case"point":f=new q1(c),f.distance=a;break;case"spot":f=new K1(c),f.distance=a,s.spot=s.spot||{},s.spot.innerConeAngle=s.spot.innerConeAngle!==void 0?s.spot.innerConeAngle:0,s.spot.outerConeAngle=s.spot.outerConeAngle!==void 0?s.spot.outerConeAngle:Math.PI/4,f.angle=s.spot.outerConeAngle,f.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,f.target.position.set(0,0,-1),f.add(f.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return f.position.set(0,0,0),f.decay=2,G(f,s),s.intensity!==void 0&&(f.intensity=s.intensity),f.name=t.createUniqueName(s.name||"light_"+e),n=Promise.resolve(f),t.cache.add(i,n),n}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,i=this.parser,v=i.json.nodes[e],o=(v.extensions&&v.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(s){return i._getNodeRef(t.cache,o,s)})}},i1=class{constructor(){this.name=T.KHR_MATERIALS_UNLIT}getMaterialType(){return e0}extendParams(e,t,i){let n=[];e.color=new E(1,1,1),e.opacity=1;let v=t.pbrMetallicRoughness;if(v){if(Array.isArray(v.baseColorFactor)){let r=v.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],P),e.opacity=r[3]}v.baseColorTexture!==void 0&&n.push(i.assignTexture(e,"map",v.baseColorTexture,I))}return Promise.all(n)}},r1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=n.extensions[this.name].emissiveStrength;return v!==void 0&&(t.emissiveIntensity=v),Promise.resolve()}},s1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&v.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&v.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(v.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){let o=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new $(o,o)}return Promise.all(v)}},o1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&v.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&v.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(v)}},f1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_SHEEN}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[];t.sheenColor=new E(0,0,0),t.sheenRoughness=0,t.sheen=1;let r=n.extensions[this.name];if(r.sheenColorFactor!==void 0){let o=r.sheenColorFactor;t.sheenColor.setRGB(o[0],o[1],o[2],P)}return r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&v.push(i.assignTexture(t,"sheenColorMap",r.sheenColorTexture,I)),r.sheenRoughnessTexture!==void 0&&v.push(i.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(v)}},a1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&v.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(v)}},c1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_VOLUME}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&v.push(i.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;let o=r.attenuationColor||[1,1,1];return t.attenuationColor=new E().setRGB(o[0],o[1],o[2],P),Promise.all(v)}},m1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_IOR}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=n.extensions[this.name];return t.ior=v.ior!==void 0?v.ior:1.5,Promise.resolve()}},u1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_SPECULAR}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&v.push(i.assignTexture(t,"specularIntensityMap",r.specularTexture));let o=r.specularColorFactor||[1,1,1];return t.specularColor=new E().setRGB(o[0],o[1],o[2],P),r.specularColorTexture!==void 0&&v.push(i.assignTexture(t,"specularColorMap",r.specularColorTexture,I)),Promise.all(v)}},p1=class{constructor(e){this.parser=e,this.name=T.EXT_MATERIALS_BUMP}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return t.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&v.push(i.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(v)}},l1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:D}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return r.anisotropyStrength!==void 0&&(t.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(t.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&v.push(i.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(v)}},d1=class{constructor(e){this.parser=e,this.name=T.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,i=t.json,n=i.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let v=n.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,v.source,r)}},h1=class{constructor(e){this.parser=e,this.name=T.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,n=i.json,v=n.textures[e];if(!v.extensions||!v.extensions[t])return null;let r=v.extensions[t],o=n.images[r.source],s=i.textureLoader;if(o.uri){let f=i.options.manager.getHandler(o.uri);f!==null&&(s=f)}return this.detectSupport().then(function(f){if(f)return i.loadTextureImage(e,r.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},y1=class{constructor(e){this.parser=e,this.name=T.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,n=i.json,v=n.textures[e];if(!v.extensions||!v.extensions[t])return null;let r=v.extensions[t],o=n.images[r.source],s=i.textureLoader;if(o.uri){let f=i.options.manager.getHandler(o.uri);f!==null&&(s=f)}return this.detectSupport().then(function(f){if(f)return i.loadTextureImage(e,r.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},b1=class{constructor(e){this.name=T.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){let n=i.extensions[this.name],v=this.parser.getDependency("buffer",n.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return v.then(function(o){let s=n.byteOffset||0,f=n.byteLength||0,c=n.count,a=n.byteStride,m=new Uint8Array(o,s,f);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(c,a,m,n.mode,n.filter).then(function(p){return p.buffer}):r.ready.then(function(){let p=new ArrayBuffer(c*a);return r.decodeGltfBuffer(new Uint8Array(p),c,a,m,n.mode,n.filter),p})})}else return null}},_1=class{constructor(e){this.name=T.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;let n=t.meshes[i.mesh];for(let f of n.primitives)if(f.mode!==M.TRIANGLES&&f.mode!==M.TRIANGLE_STRIP&&f.mode!==M.TRIANGLE_FAN&&f.mode!==void 0)return null;let r=i.extensions[this.name].attributes,o=[],s={};for(let f in r)o.push(this.parser.getDependency("accessor",r[f]).then(c=>(s[f]=c,s[f])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(f=>{let c=f.pop(),a=c.isGroup?c.children:[c],m=f[0].count,p=[];for(let d of a){let h=new m0,l=new V,y=new X0,b=new V(1,1,1),g=new H1(d.geometry,d.material,m);for(let _=0;_<m;_++)s.TRANSLATION&&l.fromBufferAttribute(s.TRANSLATION,_),s.ROTATION&&y.fromBufferAttribute(s.ROTATION,_),s.SCALE&&b.fromBufferAttribute(s.SCALE,_),g.setMatrixAt(_,h.compose(l,y,b));for(let _ in s)if(_==="_COLOR_0"){let R=s[_];g.instanceColor=new z0(R.array,R.itemSize,R.normalized)}else _!=="TRANSLATION"&&_!=="ROTATION"&&_!=="SCALE"&&d.geometry.setAttribute(_,s[_]);j0.prototype.copy.call(g,d),this.parser.assignFinalMaterial(g),p.push(g)}return c.isGroup?(c.clear(),c.add(...p),c):p[0]}))}},c2="glTF",l0=12,s2={JSON:1313821514,BIN:5130562},T1=class{constructor(e){this.name=T.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,l0),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==c2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let n=this.header.length-l0,v=new DataView(e,l0),r=0;for(;r<n;){let o=v.getUint32(r,!0);r+=4;let s=v.getUint32(r,!0);if(r+=4,s===s2.JSON){let f=new Uint8Array(e,l0+r,o);this.content=i.decode(f)}else if(s===s2.BIN){let f=l0+r;this.body=e.slice(f,f+o)}r+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},O1=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=T.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let i=this.json,n=this.dracoLoader,v=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,o={},s={},f={};for(let c in r){let a=w1[c]||c.toLowerCase();o[a]=r[c]}for(let c in e.attributes){let a=w1[c]||c.toLowerCase();if(r[c]!==void 0){let m=i.accessors[e.attributes[c]],p=f0[m.componentType];f[a]=p.name,s[a]=m.normalized===!0}}return t.getDependency("bufferView",v).then(function(c){return new Promise(function(a,m){n.decodeDracoFile(c,function(p){for(let d in p.attributes){let h=p.attributes[d],l=s[d];l!==void 0&&(h.normalized=l)}a(p)},o,f,P,m)})})}},A1=class{constructor(){this.name=T.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},g1=class{constructor(){this.name=T.KHR_MESH_QUANTIZATION}},N0=class extends U1{constructor(e,t,i,n){super(e,t,i,n)}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,v=e*n*3+n;for(let r=0;r!==n;r++)t[r]=i[v+r];return t}interpolate_(e,t,i,n){let v=this.resultBuffer,r=this.sampleValues,o=this.valueSize,s=o*2,f=o*3,c=n-t,a=(i-t)/c,m=a*a,p=m*a,d=e*f,h=d-f,l=-2*p+3*m,y=p-m,b=1-l,g=y-m+a;for(let _=0;_!==o;_++){let R=r[h+_+o],A=r[h+_+s]*c,w=r[d+_+o],a0=r[d+_]*c;v[_]=b*R+g*A+l*w+y*a0}return v}},w2=new X0,x1=class extends N0{interpolate_(e,t,i,n){let v=super.interpolate_(e,t,i,n);return w2.fromArray(v).normalize().toArray(v),v}},M={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},f0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},o2={9728:Q,9729:B0,9984:S1,9985:N1,9986:I1,9987:W0},f2={33071:R1,33648:L1,10497:S},e1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},w1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},U={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},V2={CUBICSPLINE:void 0,LINEAR:F0,STEP:M1},t1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function C2(u){return u.DefaultMaterial===void 0&&(u.DefaultMaterial=new K0({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:y0})),u.DefaultMaterial}function Y(u,e,t){for(let i in t.extensions)u[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function G(u,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(u.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function E2(u,e,t){let i=!1,n=!1,v=!1;for(let f=0,c=e.length;f<c;f++){let a=e[f];if(a.POSITION!==void 0&&(i=!0),a.NORMAL!==void 0&&(n=!0),a.COLOR_0!==void 0&&(v=!0),i&&n&&v)break}if(!i&&!n&&!v)return Promise.resolve(u);let r=[],o=[],s=[];for(let f=0,c=e.length;f<c;f++){let a=e[f];if(i){let m=a.POSITION!==void 0?t.getDependency("accessor",a.POSITION):u.attributes.position;r.push(m)}if(n){let m=a.NORMAL!==void 0?t.getDependency("accessor",a.NORMAL):u.attributes.normal;o.push(m)}if(v){let m=a.COLOR_0!==void 0?t.getDependency("accessor",a.COLOR_0):u.attributes.color;s.push(m)}}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(s)]).then(function(f){let c=f[0],a=f[1],m=f[2];return i&&(u.morphAttributes.position=c),n&&(u.morphAttributes.normal=a),v&&(u.morphAttributes.color=m),u.morphTargetsRelative=!0,u})}function R2(u,e){if(u.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)u.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(u.morphTargetInfluences.length===t.length){u.morphTargetDictionary={};for(let i=0,n=t.length;i<n;i++)u.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function L2(u){let e,t=u.extensions&&u.extensions[T.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+n1(t.attributes):e=u.indices+":"+n1(u.attributes)+":"+u.mode,u.targets!==void 0)for(let i=0,n=u.targets.length;i<n;i++)e+=":"+n1(u.targets[i]);return e}function n1(u){let e="",t=Object.keys(u).sort();for(let i=0,n=t.length;i<n;i++)e+=t[i]+":"+u[t[i]]+";";return e}function V1(u){switch(u){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function S2(u){return u.search(/\.jpe?g($|\?)/i)>0||u.search(/^data\:image\/jpeg/)===0?"image/jpeg":u.search(/\.webp($|\?)/i)>0||u.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}var I2=new m0,C1=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new x2,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,n=!1,v=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,n=navigator.userAgent.indexOf("Firefox")>-1,v=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||n&&v<98?this.textureLoader=new X(this.options.manager):this.textureLoader=new Y1(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new q(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let i=this,n=this.json,v=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(r){let o={scene:r[0][n.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:n.asset,parser:i,userData:{}};return Y(v,o,n),G(o,n),Promise.all(i._invokeAll(function(s){return s.afterRoot&&s.afterRoot(o)})).then(function(){for(let s of o.scenes)s.updateMatrixWorld();e(o)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let n=0,v=t.length;n<v;n++){let r=t[n].joints;for(let o=0,s=r.length;o<s;o++)e[r[o]].isBone=!0}for(let n=0,v=e.length;n<v;n++){let r=e[n];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(i[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;let n=i.clone(),v=(r,o)=>{let s=this.associations.get(r);s!=null&&this.associations.set(o,s);for(let[f,c]of r.children.entries())v(c,o.children[f])};return v(i,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){let n=e(t[i]);if(n)return n}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let i=[];for(let n=0;n<t.length;n++){let v=e(t[n]);v&&i.push(v)}return i}getDependency(e,t){let i=e+":"+t,n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(v){return v.loadNode&&v.loadNode(t)});break;case"mesh":n=this._invokeOne(function(v){return v.loadMesh&&v.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(v){return v.loadBufferView&&v.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(v){return v.loadMaterial&&v.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(v){return v.loadTexture&&v.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(v){return v.loadAnimation&&v.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne(function(v){return v!=this&&v.getDependency&&v.getDependency(e,t)}),!n)throw new Error("Unknown type: "+e);break}this.cache.add(i,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){let i=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(v,r){return i.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[T.KHR_BINARY_GLTF].body);let n=this.options;return new Promise(function(v,r){i.load(j.resolveURL(t.uri,n.path),v,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){let n=t.byteLength||0,v=t.byteOffset||0;return i.slice(v,v+n)})}loadAccessor(e){let t=this,i=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0){let r=e1[n.type],o=f0[n.componentType],s=n.normalized===!0,f=new o(n.count*r);return Promise.resolve(new u0(f,r,s))}let v=[];return n.bufferView!==void 0?v.push(this.getDependency("bufferView",n.bufferView)):v.push(null),n.sparse!==void 0&&(v.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),v.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(v).then(function(r){let o=r[0],s=e1[n.type],f=f0[n.componentType],c=f.BYTES_PER_ELEMENT,a=c*s,m=n.byteOffset||0,p=n.bufferView!==void 0?i.bufferViews[n.bufferView].byteStride:void 0,d=n.normalized===!0,h,l;if(p&&p!==a){let y=Math.floor(m/p),b="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+y+":"+n.count,g=t.cache.get(b);g||(h=new f(o,y*p,n.count*p/c),g=new U0(h,p/c),t.cache.add(b,g)),l=new G0(g,s,m%p/c,d)}else o===null?h=new f(n.count*s):h=new f(o,m,n.count*s),l=new u0(h,s,d);if(n.sparse!==void 0){let y=e1.SCALAR,b=f0[n.sparse.indices.componentType],g=n.sparse.indices.byteOffset||0,_=n.sparse.values.byteOffset||0,R=new b(r[1],g,n.sparse.count*y),A=new f(r[2],_,n.sparse.count*s);o!==null&&(l=new u0(l.array.slice(),l.itemSize,l.normalized));for(let w=0,a0=R.length;w<a0;w++){let W=R[w];if(l.setX(W,A[w*s]),s>=2&&l.setY(W,A[w*s+1]),s>=3&&l.setZ(W,A[w*s+2]),s>=4&&l.setW(W,A[w*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return l})}loadTexture(e){let t=this.json,i=this.options,v=t.textures[e].source,r=t.images[v],o=this.textureLoader;if(r.uri){let s=i.manager.getHandler(r.uri);s!==null&&(o=s)}return this.loadTextureImage(e,v,o)}loadTextureImage(e,t,i){let n=this,v=this.json,r=v.textures[e],o=v.images[t],s=(o.uri||o.bufferView)+":"+r.sampler;if(this.textureCache[s])return this.textureCache[s];let f=this.loadImageSource(t,i).then(function(c){c.flipY=!1,c.name=r.name||o.name||"",c.name===""&&typeof o.uri=="string"&&o.uri.startsWith("data:image/")===!1&&(c.name=o.uri);let m=(v.samplers||{})[r.sampler]||{};return c.magFilter=o2[m.magFilter]||B0,c.minFilter=o2[m.minFilter]||W0,c.wrapS=f2[m.wrapS]||S,c.wrapT=f2[m.wrapT]||S,n.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[s]=f,f}loadImageSource(e,t){let i=this,n=this.json,v=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(a=>a.clone());let r=n.images[e],o=self.URL||self.webkitURL,s=r.uri||"",f=!1;if(r.bufferView!==void 0)s=i.getDependency("bufferView",r.bufferView).then(function(a){f=!0;let m=new Blob([a],{type:r.mimeType});return s=o.createObjectURL(m),s});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let c=Promise.resolve(s).then(function(a){return new Promise(function(m,p){let d=m;t.isImageBitmapLoader===!0&&(d=function(h){let l=new H0(h);l.needsUpdate=!0,m(l)}),t.load(j.resolveURL(a,v.path),d,void 0,p)})}).then(function(a){return f===!0&&o.revokeObjectURL(s),a.userData.mimeType=r.mimeType||S2(r.uri),a}).catch(function(a){throw console.error("THREE.GLTFLoader: Couldn't load texture",s),a});return this.sourceCache[e]=c,c}assignTexture(e,t,i,n){let v=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(r=r.clone(),r.channel=i.texCoord),v.extensions[T.KHR_TEXTURE_TRANSFORM]){let o=i.extensions!==void 0?i.extensions[T.KHR_TEXTURE_TRANSFORM]:void 0;if(o){let s=v.associations.get(r);r=v.extensions[T.KHR_TEXTURE_TRANSFORM].extendTexture(r,o),v.associations.set(r,s)}}return n!==void 0&&(r.colorSpace=n),e[t]=r,r})}assignFinalMaterial(e){let t=e.geometry,i=e.material,n=t.attributes.tangent===void 0,v=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){let o="PointsMaterial:"+i.uuid,s=this.cache.get(o);s||(s=new K,z.prototype.copy.call(s,i),s.color.copy(i.color),s.map=i.map,s.sizeAttenuation=!1,this.cache.add(o,s)),i=s}else if(e.isLine){let o="LineBasicMaterial:"+i.uuid,s=this.cache.get(o);s||(s=new i0,z.prototype.copy.call(s,i),s.color.copy(i.color),s.map=i.map,this.cache.add(o,s)),i=s}if(n||v||r){let o="ClonedMaterial:"+i.uuid+":";n&&(o+="derivative-tangents:"),v&&(o+="vertex-colors:"),r&&(o+="flat-shading:");let s=this.cache.get(o);s||(s=i.clone(),v&&(s.vertexColors=!0),r&&(s.flatShading=!0),n&&(s.normalScale&&(s.normalScale.y*=-1),s.clearcoatNormalScale&&(s.clearcoatNormalScale.y*=-1)),this.cache.add(o,s),this.associations.set(s,this.associations.get(i))),i=s}e.material=i}getMaterialType(){return K0}loadMaterial(e){let t=this,i=this.json,n=this.extensions,v=i.materials[e],r,o={},s=v.extensions||{},f=[];if(s[T.KHR_MATERIALS_UNLIT]){let a=n[T.KHR_MATERIALS_UNLIT];r=a.getMaterialType(),f.push(a.extendParams(o,v,t))}else{let a=v.pbrMetallicRoughness||{};if(o.color=new E(1,1,1),o.opacity=1,Array.isArray(a.baseColorFactor)){let m=a.baseColorFactor;o.color.setRGB(m[0],m[1],m[2],P),o.opacity=m[3]}a.baseColorTexture!==void 0&&f.push(t.assignTexture(o,"map",a.baseColorTexture,I)),o.metalness=a.metallicFactor!==void 0?a.metallicFactor:1,o.roughness=a.roughnessFactor!==void 0?a.roughnessFactor:1,a.metallicRoughnessTexture!==void 0&&(f.push(t.assignTexture(o,"metalnessMap",a.metallicRoughnessTexture)),f.push(t.assignTexture(o,"roughnessMap",a.metallicRoughnessTexture))),r=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),f.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,o)})))}v.doubleSided===!0&&(o.side=J);let c=v.alphaMode||t1.OPAQUE;if(c===t1.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,c===t1.MASK&&(o.alphaTest=v.alphaCutoff!==void 0?v.alphaCutoff:.5)),v.normalTexture!==void 0&&r!==e0&&(f.push(t.assignTexture(o,"normalMap",v.normalTexture)),o.normalScale=new $(1,1),v.normalTexture.scale!==void 0)){let a=v.normalTexture.scale;o.normalScale.set(a,a)}if(v.occlusionTexture!==void 0&&r!==e0&&(f.push(t.assignTexture(o,"aoMap",v.occlusionTexture)),v.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=v.occlusionTexture.strength)),v.emissiveFactor!==void 0&&r!==e0){let a=v.emissiveFactor;o.emissive=new E().setRGB(a[0],a[1],a[2],P)}return v.emissiveTexture!==void 0&&r!==e0&&f.push(t.assignTexture(o,"emissiveMap",v.emissiveTexture,I)),Promise.all(f).then(function(){let a=new r(o);return v.name&&(a.name=v.name),G(a,v),t.associations.set(a,{materials:e}),v.extensions&&Y(n,a,v),a})}createUniqueName(e){let t=Z1.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,i=this.extensions,n=this.primitiveCache;function v(o){return i[T.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(s){return a2(s,o,t)})}let r=[];for(let o=0,s=e.length;o<s;o++){let f=e[o],c=L2(f),a=n[c];if(a)r.push(a.promise);else{let m;f.extensions&&f.extensions[T.KHR_DRACO_MESH_COMPRESSION]?m=v(f):m=a2(new t0,f,t),n[c]={primitive:f,promise:m},r.push(m)}}return Promise.all(r)}loadMesh(e){let t=this,i=this.json,n=this.extensions,v=i.meshes[e],r=v.primitives,o=[];for(let s=0,f=r.length;s<f;s++){let c=r[s].material===void 0?C2(this.cache):this.getDependency("material",r[s].material);o.push(c)}return o.push(t.loadGeometries(r)),Promise.all(o).then(function(s){let f=s.slice(0,s.length-1),c=s[s.length-1],a=[];for(let p=0,d=c.length;p<d;p++){let h=c[p],l=r[p],y,b=f[p];if(l.mode===M.TRIANGLES||l.mode===M.TRIANGLE_STRIP||l.mode===M.TRIANGLE_FAN||l.mode===void 0)y=v.isSkinnedMesh===!0?new W1(h,b):new B(h,b),y.isSkinnedMesh===!0&&y.normalizeSkinWeights(),l.mode===M.TRIANGLE_STRIP?y.geometry=$0(y.geometry,b0):l.mode===M.TRIANGLE_FAN&&(y.geometry=$0(y.geometry,c0));else if(l.mode===M.LINES)y=new p0(h,b);else if(l.mode===M.LINE_STRIP)y=new X1(h,b);else if(l.mode===M.LINE_LOOP)y=new j1(h,b);else if(l.mode===M.POINTS)y=new r0(h,b);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+l.mode);Object.keys(y.geometry.morphAttributes).length>0&&R2(y,v),y.name=t.createUniqueName(v.name||"mesh_"+e),G(y,v),l.extensions&&Y(n,y,l),t.assignFinalMaterial(y),a.push(y)}for(let p=0,d=a.length;p<d;p++)t.associations.set(a[p],{meshes:e,primitives:p});if(a.length===1)return v.extensions&&Y(n,a[0],v),a[0];let m=new v0;v.extensions&&Y(n,m,v),t.associations.set(m,{meshes:e});for(let p=0,d=a.length;p<d;p++)m.add(a[p]);return m})}loadCamera(e){let t,i=this.json.cameras[e],n=i[i.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new n0(_0.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):i.type==="orthographic"&&(t=new B1(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),G(t,i),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],i=[];for(let n=0,v=t.joints.length;n<v;n++)i.push(this._loadNodeShallow(t.joints[n]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(n){let v=n.pop(),r=n,o=[],s=[];for(let f=0,c=r.length;f<c;f++){let a=r[f];if(a){o.push(a);let m=new m0;v!==null&&m.fromArray(v.array,f*16),s.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[f])}return new k1(o,s)})}loadAnimation(e){let t=this.json,i=this,n=t.animations[e],v=n.name?n.name:"animation_"+e,r=[],o=[],s=[],f=[],c=[];for(let a=0,m=n.channels.length;a<m;a++){let p=n.channels[a],d=n.samplers[p.sampler],h=p.target,l=h.node,y=n.parameters!==void 0?n.parameters[d.input]:d.input,b=n.parameters!==void 0?n.parameters[d.output]:d.output;h.node!==void 0&&(r.push(this.getDependency("node",l)),o.push(this.getDependency("accessor",y)),s.push(this.getDependency("accessor",b)),f.push(d),c.push(h))}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(s),Promise.all(f),Promise.all(c)]).then(function(a){let m=a[0],p=a[1],d=a[2],h=a[3],l=a[4],y=[];for(let b=0,g=m.length;b<g;b++){let _=m[b],R=p[b],A=d[b],w=h[b],a0=l[b];if(_===void 0)continue;_.updateMatrix&&_.updateMatrix();let W=i._createAnimationTracks(_,R,A,w,a0);if(W)for(let M0=0;M0<W.length;M0++)y.push(W[M0])}return new G1(v,void 0,y)})}createNodeMesh(e){let t=this.json,i=this,n=t.nodes[e];return n.mesh===void 0?null:i.getDependency("mesh",n.mesh).then(function(v){let r=i._getNodeRef(i.meshCache,n.mesh,v);return n.weights!==void 0&&r.traverse(function(o){if(o.isMesh)for(let s=0,f=n.weights.length;s<f;s++)o.morphTargetInfluences[s]=n.weights[s]}),r})}loadNode(e){let t=this.json,i=this,n=t.nodes[e],v=i._loadNodeShallow(e),r=[],o=n.children||[];for(let f=0,c=o.length;f<c;f++)r.push(i.getDependency("node",o[f]));let s=n.skin===void 0?Promise.resolve(null):i.getDependency("skin",n.skin);return Promise.all([v,Promise.all(r),s]).then(function(f){let c=f[0],a=f[1],m=f[2];m!==null&&c.traverse(function(p){p.isSkinnedMesh&&p.bind(m,I2)});for(let p=0,d=a.length;p<d;p++)c.add(a[p]);return c})}_loadNodeShallow(e){let t=this.json,i=this.extensions,n=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let v=t.nodes[e],r=v.name?n.createUniqueName(v.name):"",o=[],s=n._invokeOne(function(f){return f.createNodeMesh&&f.createNodeMesh(e)});return s&&o.push(s),v.camera!==void 0&&o.push(n.getDependency("camera",v.camera).then(function(f){return n._getNodeRef(n.cameraCache,v.camera,f)})),n._invokeAll(function(f){return f.createNodeAttachment&&f.createNodeAttachment(e)}).forEach(function(f){o.push(f)}),this.nodeCache[e]=Promise.all(o).then(function(f){let c;if(v.isBone===!0?c=new F1:f.length>1?c=new v0:f.length===1?c=f[0]:c=new j0,c!==f[0])for(let a=0,m=f.length;a<m;a++)c.add(f[a]);if(v.name&&(c.userData.name=v.name,c.name=r),G(c,v),v.extensions&&Y(i,c,v),v.matrix!==void 0){let a=new m0;a.fromArray(v.matrix),c.applyMatrix4(a)}else v.translation!==void 0&&c.position.fromArray(v.translation),v.rotation!==void 0&&c.quaternion.fromArray(v.rotation),v.scale!==void 0&&c.scale.fromArray(v.scale);return n.associations.has(c)||n.associations.set(c,{}),n.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){let t=this.extensions,i=this.json.scenes[e],n=this,v=new v0;i.name&&(v.name=n.createUniqueName(i.name)),G(v,i),i.extensions&&Y(t,v,i);let r=i.nodes||[],o=[];for(let s=0,f=r.length;s<f;s++)o.push(n.getDependency("node",r[s]));return Promise.all(o).then(function(s){for(let c=0,a=s.length;c<a;c++)v.add(s[c]);let f=c=>{let a=new Map;for(let[m,p]of n.associations)(m instanceof z||m instanceof H0)&&a.set(m,p);return c.traverse(m=>{let p=n.associations.get(m);p!=null&&a.set(m,p)}),a};return n.associations=f(v),v})}_createAnimationTracks(e,t,i,n,v){let r=[],o=e.name?e.name:e.uuid,s=[];U[v.path]===U.weights?e.traverse(function(m){m.morphTargetInfluences&&s.push(m.name?m.name:m.uuid)}):s.push(o);let f;switch(U[v.path]){case U.weights:f=q0;break;case U.rotation:f=Y0;break;case U.position:case U.scale:f=Z0;break;default:switch(i.itemSize){case 1:f=q0;break;case 2:case 3:default:f=Z0;break}break}let c=n.interpolation!==void 0?V2[n.interpolation]:F0,a=this._getArrayFromAccessor(i);for(let m=0,p=s.length;m<p;m++){let d=new f(s[m]+"."+U[v.path],t.array,a,c);n.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(d),r.push(d)}return r}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let i=V1(t.constructor),n=new Float32Array(t.length);for(let v=0,r=t.length;v<r;v++)n[v]=t[v]*i;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){let n=this instanceof Y0?x1:N0;return new n(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function N2(u,e,t){let i=e.attributes,n=new T0;if(i.POSITION!==void 0){let o=t.json.accessors[i.POSITION],s=o.min,f=o.max;if(s!==void 0&&f!==void 0){if(n.set(new V(s[0],s[1],s[2]),new V(f[0],f[1],f[2])),o.normalized){let c=V1(f0[o.componentType]);n.min.multiplyScalar(c),n.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let v=e.targets;if(v!==void 0){let o=new V,s=new V;for(let f=0,c=v.length;f<c;f++){let a=v[f];if(a.POSITION!==void 0){let m=t.json.accessors[a.POSITION],p=m.min,d=m.max;if(p!==void 0&&d!==void 0){if(s.setX(Math.max(Math.abs(p[0]),Math.abs(d[0]))),s.setY(Math.max(Math.abs(p[1]),Math.abs(d[1]))),s.setZ(Math.max(Math.abs(p[2]),Math.abs(d[2]))),m.normalized){let h=V1(f0[m.componentType]);s.multiplyScalar(h)}o.max(s)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(o)}u.boundingBox=n;let r=new D1;n.getCenter(r.center),r.radius=n.min.distanceTo(n.max)/2,u.boundingSphere=r}function a2(u,e,t){let i=e.attributes,n=[];function v(r,o){return t.getDependency("accessor",r).then(function(s){u.setAttribute(o,s)})}for(let r in i){let o=w1[r]||r.toLowerCase();o in u.attributes||n.push(v(i[r],o))}if(e.indices!==void 0&&!u.index){let r=t.getDependency("accessor",e.indices).then(function(o){u.setIndex(o)});n.push(r)}return k0.workingColorSpace!==P&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${k0.workingColorSpace}" not supported.`),G(u,e),N2(u,e,t),Promise.all(n).then(function(){return e.targets!==void 0?E2(u,e.targets,t):u})}var m2="https://mzmpy.github.io/mynotes-es/assets/gltf/scene-TUQFAHXQ.gltf";var u2=Z({name:"ThreeJsSmallCity",setup(){let u=F(),e=d0(),t=F(0),i=F(""),n=new x0,v=new g0,r=new n0(45,3/2,.1,5e3),o=new o0(16777215,2.5),s=new w0(11657727,12155424,2);r.position.set(0,10,35),o.position.set(0,10,0),o.target.position.set(-5,0,0),o.castShadow=!0,h0(()=>{let m=new O0(40,40),p=new C0(r,u.value);new X(n).load(E0,l=>{l.colorSpace=I,l.wrapS=S,l.wrapT=S,l.magFilter=Q,l.repeat.set(40/2,40/2);let y=new H({map:l,side:J}),b=new B(m,y);b.rotation.x=-.5*Math.PI,b.receiveShadow=!0,v.add(b)}),new I0(n).load(m2,l=>{let y=l.scene;v.add(y);let b=new T0().setFromObject(y),g=b.getSize(new V).length(),_=b.getCenter(new V);c(g*.5,g,_,r),p.maxDistance=g*10,p.target.copy(_)}),n.onProgress=(l,y,b)=>{let g=Math.round(y/b*100);console.log(`loaded ${g}%`,l),i.value="\u6B63\u5728\u52A0\u8F7D\u8D44\u6E90...",t.value=g},e.value=new A0({antialias:!0,canvas:u.value}),e.value.shadowMap.enabled=!0,e.value.setPixelRatio(10),v.add(s,o),v.background=new E(0),p.target.set(0,5,0),p.update(),requestAnimationFrame(f)});let f=()=>{e.value.render(v,r),requestAnimationFrame(f)},c=(a,m,p,d)=>{let h=a*.5,l=_0.degToRad(d.fov*.5),y=h/Math.tan(l),b=new V().subVectors(d.position,p).multiply(new V(1,0,1)).normalize();d.position.copy(b.multiplyScalar(y).add(p)),d.near=m/100,d.far=m*100,d.updateProjectionMatrix(),d.lookAt(p.x,p.y,p.z)};return()=>C(L,null,C(V0,{showAnimation:!1,progress:t.value,progressTitle:i.value},{canvas:()=>C("canvas",{class:r2("gl-canvas"),ref:u})}))}});function p2(u){let e=Object.assign({h1:"h1",code:"code",h2:"h2",ul:"ul",li:"li",p:"p"},D0(),u.components);return O.h(O.Fragment,null,O.h(e.h1,null,"\u4F7F\u7528",O.h(e.code,null,".obj"),"\u548C",O.h(e.code,null,".gltf"),"\u6587\u4EF6\u52A0\u8F7D",O.h(e.code,null,"3D"),"\u6A21\u578B"),`
`,O.h(e.h2,null,"\u4F7F\u7528",O.h(e.code,null,".obj"),"\u6587\u4EF6"),`
`,O.h(i2),`
`,O.h(e.h2,null,"\u4F7F\u7528",O.h(e.code,null,".gltf"),"\u6587\u4EF6"),`
`,O.h(e.ul,null,`
`,O.h(e.li,null,`
`,O.h(e.p,null,O.h(e.code,null,"gltf"),"\u683C\u5F0F\u7684\u4F18\u70B9\uFF1A"),`
`,O.h(e.ul,null,`
`,O.h(e.li,null,"\u4F53\u79EF\u5C0F\uFF0C\u9002\u5408\u7528\u4E8E\u4F20\u8F93"),`
`,O.h(e.li,null,"\u6613\u4E8E\u88AB\u6E32\u67D3"),`
`),`
`,O.h(u2),`
`),`
`))}function P2(u={}){let{wrapper:e}=Object.assign({},D0(),u.components);return e?O.h(e,u,O.h(p2,u)):p2(u)}var E1=P2;var D9=Z({name:"MDX_05-USE-OBJ-AND-GLTF",components:{MDXComponentContext:E1},setup(u,e){return()=>C("div",{class:"markdown-body",style:"padding: 15px;"},C(E1,{...e?.attrs}))}});export{D9 as default};
