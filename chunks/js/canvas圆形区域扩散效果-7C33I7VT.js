import{a as B,b as R,c as U}from"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-IKRLYDKX.js";import{a as L}from"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-ZH6BUNSG.js";import{I as C,N as S,ba as d,d as q,f as a,g as m,qa as c,ya as X,z as O}from"https://mzmpy.github.io/mynotes-es/chunks/js/chunk-6MPDC5UM.js";m();X();m();m();m();X();var e=q(B(),1);m();var G={"map-container":{name:"src__components__mdx__constituents__leaflet__canvas-circle__index-vrwU7G-map-container",composes:[],isReferenced:!1}},Z=(o=>t=>{if(typeof t!="string")throw new TypeError("resolveStyles: parameter 'className' must be a string.");return o[t.replace(/[A-Z]/g,s=>"-"+s.toLowerCase())].name})(G);var z=C({name:"CanvasCircle",setup(){let o=O(),t=[39.910088,116.401601],s,p,u;return S(()=>{s=e.map(o.value,{zoom:12,center:t,zoomAnimation:!0}),e.tileLayer.chinaProvider("GaoDe.Normal.Map",{minZoom:3,maxZoom:18}).addTo(s),e.marker(t).addTo(s);let w=R({container:document.createElement("canvas"),padding:0,minZoom:1,maxZoom:18,opacity:.5});w.on("layer-render",function(){console.log("======= layer render =======",p),p&&e.Util.cancelAnimFrame(p);let l=this.getContainer(),n=l.getContext("2d"),g=this._bounds.getSize(),f=e.Browser.retina?2:1;l.width=f*g.x,l.height=f*g.y,l.style.width=g.x+"px",l.style.height=g.y+"px",e.Browser.retina&&n.scale(f,f);let x=[t[1],t[0]],b=U(x,5e3,0,{units:"meters"}).geometry.coordinates,y=s.latLngToContainerPoint({lat:x[1],lng:x[0]}),_=s.latLngToContainerPoint({lat:b[1],lng:b[0]}).distanceTo(y),E=s.getZoom(),v=_/Math.pow(2,E-10),h=250;n.lineWidth=_/h;let F=(r,i=30)=>(r=Math.max(0,Math.min(1,r)),1/(1+Math.exp(-i*(r-.975)))),P=(r,i)=>{let T=i%v,D=r*v/h,j=D>T?0:D/T;n.beginPath(),n.strokeStyle=`rgba(251, 30, 10, ${F(j)})`,n.arc(y.x,y.y,r*_/h,0,Math.PI*2),n.stroke(),n.closePath()},V=(r=0)=>{for(let i=0;i<h;i++)P(i,r),P(i,r-v/2)},A=r=>{let i=n.globalCompositeOperation;n.globalCompositeOperation="destination-in",n.globalAlpha=.975,n.fillRect(0,0,l.width,l.height),n.globalCompositeOperation=i,u=u||r,V((r-u)/200),p=e.Util.requestAnimFrame(A)};p=e.Util.requestAnimFrame(A)}),w.addTo(s)}),()=>c(d,null,c("div",{class:Z("map-container"),ref:o}))}});function k(o){let t=Object.assign({h1:"h1"},L(),o.components);return a.h(a.Fragment,null,a.h(t.h1,null,"canvas\u5706\u5F62\u533A\u57DF\u6269\u6563\u6548\u679C"),`
`,a.h(z))}function I(o={}){let{wrapper:t}=Object.assign({},L(),o.components);return t?a.h(t,o,a.h(k,o)):k(o)}var M=I;var ut=C({name:"MDX_CANVAS\u5706\u5F62\u533A\u57DF\u6269\u6563\u6548\u679C",components:{MDXComponentContext:M},setup(o,t){return()=>c("div",{class:"markdown-body",style:"padding: 15px;"},c(M,{...t?.attrs}))}});export{ut as default};
