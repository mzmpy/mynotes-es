import{a as V0,b as C0}from"./chunk-JGXREM6M.js";import{$ as G0,A as H0,Aa as q1,B as V,Ba as Y1,C as T0,D as D1,F as c0,Fa as w0,G as X0,H as E,I as G,J as $,K as m0,L as F,M as e0,N as B,P as t0,R as O0,S as P1,T as n0,U as A0,V as g0,W as j0,X as U0,Y as B1,Z as W1,_ as F1,aa as k1,ba as v0,c as y0,ca as H1,da as u0,e as Z,ea as X1,f as L,fa as z,g as E1,ga as i0,h as R1,i as J,ia as z0,j as S1,ja as P,k as L1,ka as k,l as P0,la as j1,m as I1,ma as K0,n as B0,na as q0,o as N1,oa as Y0,p as W0,pa as U1,q as M1,r as b0,ra as G1,s as a0,sa as r0,t as I,ta as K,u as D,ua as H,va as x0,w as _0,wa as z1,x as Q,xa as K1,y as F0,ya as s0,z as k0,za as X}from"./chunk-JDJ5FYDV.js";import"./chunk-NIX3CF7H.js";import{a as D0}from"./chunk-LNJVFRMH.js";import{J as Y,N as h0,_ as S,d as O,e as g,na as C,va as M0,x as l0,y as d0}from"./chunk-OXERZ7B4.js";g();M0();g();g();g();M0();g();var p2={"gl-canvas":{name:"src__components__mdx__constituents__threejs__use-obj-and-gltf__windmill__index-DiiN-q-gl-canvas",composes:[],isReferenced:!1}},Z1=(u=>e=>{if(typeof e!="string")throw new TypeError("resolveStyles: parameter 'className' must be a string.");return u[e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase())].name})(p2);g();var l2=/^[og]\s*(.+)?/,d2=/^mtllib /,h2=/^usemtl /,y2=/^usemap /,J1=/\s+/,Q1=new V,Z0=new V,$1=new V,e2=new V,N=new V,E0=new E;function b2(){let u={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}let i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(n,v){let r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);let f={index:this.materials.length,name:n||"",mtllib:Array.isArray(v)&&v.length>0?v[v.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(s){let o={index:typeof s=="number"?s:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return o.clone=this.clone.bind(o),o}};return this.materials.push(f),f},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(n){let v=this.currentMaterial();if(v&&v.groupEnd===-1&&(v.groupEnd=this.geometry.vertices.length/3,v.groupCount=v.groupEnd-v.groupStart,v.inherited=!1),n&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return n&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),v}},i&&i.name&&typeof i.clone=="function"){let n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){let i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseNormalIndex:function(e,t){let i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseUVIndex:function(e,t){let i=parseInt(e,10);return(i>=0?i-1:i+t/2)*2},addVertex:function(e,t,i){let n=this.vertices,v=this.object.geometry.vertices;v.push(n[e+0],n[e+1],n[e+2]),v.push(n[t+0],n[t+1],n[t+2]),v.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){let n=this.normals,v=this.object.geometry.normals;v.push(n[e+0],n[e+1],n[e+2]),v.push(n[t+0],n[t+1],n[t+2]),v.push(n[i+0],n[i+1],n[i+2])},addFaceNormal:function(e,t,i){let n=this.vertices,v=this.object.geometry.normals;Q1.fromArray(n,e),Z0.fromArray(n,t),$1.fromArray(n,i),N.subVectors($1,Z0),e2.subVectors(Q1,Z0),N.cross(e2),N.normalize(),v.push(N.x,N.y,N.z),v.push(N.x,N.y,N.z),v.push(N.x,N.y,N.z)},addColor:function(e,t,i){let n=this.colors,v=this.object.geometry.colors;n[e]!==void 0&&v.push(n[e+0],n[e+1],n[e+2]),n[t]!==void 0&&v.push(n[t+0],n[t+1],n[t+2]),n[i]!==void 0&&v.push(n[i+0],n[i+1],n[i+2])},addUV:function(e,t,i){let n=this.uvs,v=this.object.geometry.uvs;v.push(n[e+0],n[e+1]),v.push(n[t+0],n[t+1]),v.push(n[i+0],n[i+1])},addDefaultUV:function(){let e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){let t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,n,v,r,f,s,o){let c=this.vertices.length,a=this.parseVertexIndex(e,c),m=this.parseVertexIndex(t,c),p=this.parseVertexIndex(i,c);if(this.addVertex(a,m,p),this.addColor(a,m,p),f!==void 0&&f!==""){let l=this.normals.length;a=this.parseNormalIndex(f,l),m=this.parseNormalIndex(s,l),p=this.parseNormalIndex(o,l),this.addNormal(a,m,p)}else this.addFaceNormal(a,m,p);if(n!==void 0&&n!==""){let l=this.uvs.length;a=this.parseUVIndex(n,l),m=this.parseUVIndex(v,l),p=this.parseUVIndex(r,l),this.addUV(a,m,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";let t=this.vertices.length;for(let i=0,n=e.length;i<n;i++){let v=this.parseVertexIndex(e[i],t);this.addVertexPoint(v),this.addColor(v)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";let i=this.vertices.length,n=this.uvs.length;for(let v=0,r=e.length;v<r;v++)this.addVertexLine(this.parseVertexIndex(e[v],i));for(let v=0,r=t.length;v<r;v++)this.addUVLine(this.parseUVIndex(t[v],n))}};return u.startObject("",!1),u}var R0=class extends r0{constructor(e){super(e),this.materials=null}load(e,t,i,n){let v=this,r=new K(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(f){try{t(v.parse(f))}catch(s){n?n(s):console.error(s),v.manager.itemError(e)}},i,n)}setMaterials(e){return this.materials=e,this}parse(e){let t=new b2;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));let i=e.split(`
`),n=[];for(let f=0,s=i.length;f<s;f++){let o=i[f].trimStart();if(o.length===0)continue;let c=o.charAt(0);if(c!=="#")if(c==="v"){let a=o.split(J1);switch(a[0]){case"v":t.vertices.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3])),a.length>=7?(E0.setRGB(parseFloat(a[4]),parseFloat(a[5]),parseFloat(a[6])).convertSRGBToLinear(),t.colors.push(E0.r,E0.g,E0.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));break;case"vt":t.uvs.push(parseFloat(a[1]),parseFloat(a[2]));break}}else if(c==="f"){let m=o.slice(1).trim().split(J1),p=[];for(let h=0,d=m.length;h<d;h++){let y=m[h];if(y.length>0){let b=y.split("/");p.push(b)}}let l=p[0];for(let h=1,d=p.length-1;h<d;h++){let y=p[h],b=p[h+1];t.addFace(l[0],y[0],b[0],l[1],y[1],b[1],l[2],y[2],b[2])}}else if(c==="l"){let a=o.substring(1).trim().split(" "),m=[],p=[];if(o.indexOf("/")===-1)m=a;else for(let l=0,h=a.length;l<h;l++){let d=a[l].split("/");d[0]!==""&&m.push(d[0]),d[1]!==""&&p.push(d[1])}t.addLineGeometry(m,p)}else if(c==="p"){let m=o.slice(1).trim().split(" ");t.addPointGeometry(m)}else if((n=l2.exec(o))!==null){let a=(" "+n[0].slice(1).trim()).slice(1);t.startObject(a)}else if(h2.test(o))t.object.startMaterial(o.substring(7).trim(),t.materialLibraries);else if(d2.test(o))t.materialLibraries.push(o.substring(7).trim());else if(y2.test(o))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(c==="s"){if(n=o.split(" "),n.length>1){let m=n[1].trim().toLowerCase();t.object.smooth=m!=="0"&&m!=="off"}else t.object.smooth=!0;let a=t.object.currentMaterial();a&&(a.smooth=t.object.smooth)}else{if(o==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+o+'"')}}t.finalize();let v=new n0;if(v.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let f=0,s=t.objects.length;f<s;f++){let o=t.objects[f],c=o.geometry,a=o.materials,m=c.type==="Line",p=c.type==="Points",l=!1;if(c.vertices.length===0)continue;let h=new e0;h.setAttribute("position",new F(c.vertices,3)),c.normals.length>0&&h.setAttribute("normal",new F(c.normals,3)),c.colors.length>0&&(l=!0,h.setAttribute("color",new F(c.colors,3))),c.hasUVIndices===!0&&h.setAttribute("uv",new F(c.uvs,2));let d=[];for(let b=0,x=a.length;b<x;b++){let _=a[b],R=_.name+"_"+_.smooth+"_"+l,A=t.materials[R];if(this.materials!==null){if(A=this.materials.create(_.name),m&&A&&!(A instanceof v0)){let w=new v0;G.prototype.copy.call(w,A),w.color.copy(A.color),A=w}else if(p&&A&&!(A instanceof z)){let w=new z({size:10,sizeAttenuation:!1});G.prototype.copy.call(w,A),w.color.copy(A.color),w.map=A.map,A=w}}A===void 0&&(m?A=new v0:p?A=new z({size:1,sizeAttenuation:!1}):A=new k,A.name=_.name,A.flatShading=!_.smooth,A.vertexColors=l,t.materials[R]=A),d.push(A)}let y;if(d.length>1){for(let b=0,x=a.length;b<x;b++){let _=a[b];h.addGroup(_.groupStart,_.groupCount,b)}m?y=new u0(h,d):p?y=new i0(h,d):y=new B(h,d)}else m?y=new u0(h,d[0]):p?y=new i0(h,d[0]):y=new B(h,d[0]);y.name=o.name,v.add(y)}else if(t.vertices.length>0){let f=new z({size:1,sizeAttenuation:!1}),s=new e0;s.setAttribute("position",new F(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(s.setAttribute("color",new F(t.colors,3)),f.vertexColors=!0);let o=new i0(s,f);v.add(o)}return v}};g();var S0=class extends r0{constructor(e){super(e)}load(e,t,i,n){let v=this,r=this.path===""?X.extractUrlBase(e):this.path,f=new K(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(s){try{t(v.parse(s,r))}catch(o){n?n(o):console.error(o),v.manager.itemError(e)}},i,n)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){let i=e.split(`
`),n={},v=/\s+/,r={};for(let s=0;s<i.length;s++){let o=i[s];if(o=o.trim(),o.length===0||o.charAt(0)==="#")continue;let c=o.indexOf(" "),a=c>=0?o.substring(0,c):o;a=a.toLowerCase();let m=c>=0?o.substring(c+1):"";if(m=m.trim(),a==="newmtl")n={name:m},r[m]=n;else if(a==="ka"||a==="kd"||a==="ks"||a==="ke"){let p=m.split(v,3);n[a]=[parseFloat(p[0]),parseFloat(p[1]),parseFloat(p[2])]}else n[a]=m}let f=new J0(this.resourcePath||t,this.materialOptions);return f.setCrossOrigin(this.crossOrigin),f.setManager(this.manager),f.setMaterials(r),f}},J0=class{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:y0,this.wrap=this.options.wrap!==void 0?this.options.wrap:L}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;let t={};for(let i in e){let n=e[i],v={};t[i]=v;for(let r in n){let f=!0,s=n[r],o=r.toLowerCase();switch(o){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&s[0]===0&&s[1]===0&&s[2]===0&&(f=!1);break;default:break}f&&(v[o]=s)}}return t}preload(){for(let e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(let t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){let t=this,i=this.materialsInfo[e],n={name:e,side:this.side};function v(f,s){return typeof s!="string"||s===""?"":/^https?:\/\//i.test(s)?s:f+s}function r(f,s){if(n[f])return;let o=t.getTextureParams(s,n),c=t.loadTexture(v(t.baseUrl,o.url));c.repeat.copy(o.scale),c.offset.copy(o.offset),c.wrapS=t.wrap,c.wrapT=t.wrap,(f==="map"||f==="emissiveMap")&&(c.colorSpace=I),n[f]=c}for(let f in i){let s=i[f],o;if(s!=="")switch(f.toLowerCase()){case"kd":n.color=new E().fromArray(s).convertSRGBToLinear();break;case"ks":n.specular=new E().fromArray(s).convertSRGBToLinear();break;case"ke":n.emissive=new E().fromArray(s).convertSRGBToLinear();break;case"map_kd":r("map",s);break;case"map_ks":r("specularMap",s);break;case"map_ke":r("emissiveMap",s);break;case"norm":r("normalMap",s);break;case"map_bump":case"bump":r("bumpMap",s);break;case"map_d":r("alphaMap",s),n.transparent=!0;break;case"ns":n.shininess=parseFloat(s);break;case"d":o=parseFloat(s),o<1&&(n.opacity=o,n.transparent=!0);break;case"tr":o=parseFloat(s),this.options&&this.options.invertTrProperty&&(o=1-o),o>0&&(n.opacity=1-o,n.transparent=!0);break;default:break}}return this.materials[e]=new k(n),this.materials[e]}getTextureParams(e,t){let i={scale:new Q(1,1),offset:new Q(0,0)},n=e.split(/\s+/),v;return v=n.indexOf("-bm"),v>=0&&(t.bumpScale=parseFloat(n[v+1]),n.splice(v,2)),v=n.indexOf("-s"),v>=0&&(i.scale.set(parseFloat(n[v+1]),parseFloat(n[v+2])),n.splice(v,4)),v=n.indexOf("-o"),v>=0&&(i.offset.set(parseFloat(n[v+1]),parseFloat(n[v+2])),n.splice(v,4)),i.url=n.join(" ").trim(),i}loadTexture(e,t,i,n,v){let r=this.manager!==void 0?this.manager:G1,f=r.getHandler(e);f===null&&(f=new H(r)),f.setCrossOrigin&&f.setCrossOrigin(this.crossOrigin);let s=f.load(e,i,n,v);return t!==void 0&&(s.mapping=t),s}};var t2="../../assets/obj/windmill_001-XQOMCDYN.obj";var n2="../../assets/mtl/windmill_001-RVADYG7F.mtl";var v2=Y({name:"ThreeJsWindmill",setup(){let u=l0(),e=d0(),t=new g0,i=new t0(45,3/2,.1,500),n=new s0(16777215,2.5),v=new x0(11657727,12155424,2);i.position.set(0,10,35),n.position.set(0,10,0),n.target.position.set(-5,0,0),n.castShadow=!0,h0(()=>{let s=new O0(40,40);new H().load(C0,m=>{m.colorSpace=I,m.wrapS=L,m.wrapT=L,m.magFilter=J,m.repeat.set(40/2,40/2);let p=new k({map:m,side:Z}),l=new B(s,p);l.rotation.x=-.5*Math.PI,l.receiveShadow=!0,t.add(l)}),new S0().load(n2,m=>{m.preload();let p=new R0;p.setMaterials(m),p.load(t2,l=>{t.add(l)})}),e.value=new A0({antialias:!0,canvas:u.value}),e.value.shadowMap.enabled=!0,e.value.setPixelRatio(10),t.add(v,n),t.background=new E(0);let a=new V0(i,u.value);a.target.set(0,5,0),a.update(),requestAnimationFrame(r)});let r=()=>{e.value.render(t,i),requestAnimationFrame(r)};return()=>C(S,null,C(w0,{showAnimation:!1},{canvas:()=>C("canvas",{class:Z1("gl-canvas"),ref:u})}))}});g();M0();g();var A2={"gl-canvas":{name:"src__components__mdx__constituents__threejs__use-obj-and-gltf__smallCity__index-GDTK7G-gl-canvas",composes:[],isReferenced:!1}},i2=(u=>e=>{if(typeof e!="string")throw new TypeError("resolveStyles: parameter 'className' must be a string.");return u[e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase())].name})(A2);g();g();function Q0(u,e){if(e===M1)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),u;if(e===a0||e===b0){let t=u.getIndex();if(t===null){let r=[],f=u.getAttribute("position");if(f!==void 0){for(let s=0;s<f.count;s++)r.push(s);u.setIndex(r),t=u.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),u}let i=t.count-2,n=[];if(e===a0)for(let r=1;r<=i;r++)n.push(t.getX(0)),n.push(t.getX(r)),n.push(t.getX(r+1));else for(let r=0;r<i;r++)r%2===0?(n.push(t.getX(r)),n.push(t.getX(r+1)),n.push(t.getX(r+2))):(n.push(t.getX(r+2)),n.push(t.getX(r+1)),n.push(t.getX(r)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let v=u.clone();return v.setIndex(n),v.clearGroups(),v}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),u}var L0=class extends r0{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new r1(t)}),this.register(function(t){return new l1(t)}),this.register(function(t){return new d1(t)}),this.register(function(t){return new h1(t)}),this.register(function(t){return new o1(t)}),this.register(function(t){return new f1(t)}),this.register(function(t){return new a1(t)}),this.register(function(t){return new c1(t)}),this.register(function(t){return new i1(t)}),this.register(function(t){return new m1(t)}),this.register(function(t){return new s1(t)}),this.register(function(t){return new p1(t)}),this.register(function(t){return new u1(t)}),this.register(function(t){return new n1(t)}),this.register(function(t){return new y1(t)}),this.register(function(t){return new b1(t)})}load(e,t,i,n){let v=this,r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){let o=X.extractUrlBase(e);r=X.resolveURL(o,this.path)}else r=X.extractUrlBase(e);this.manager.itemStart(e);let f=function(o){n?n(o):console.error(o),v.manager.itemError(e),v.manager.itemEnd(e)},s=new K(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(o){try{v.parse(o,r,function(c){t(c),v.manager.itemEnd(e)},f)}catch(c){f(c)}},i,f)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let v,r={},f={},s=new TextDecoder;if(typeof e=="string")v=JSON.parse(e);else if(e instanceof ArrayBuffer)if(s.decode(new Uint8Array(e,0,4))===a2){try{r[T.KHR_BINARY_GLTF]=new _1(e)}catch(a){n&&n(a);return}v=JSON.parse(r[T.KHR_BINARY_GLTF].content)}else v=JSON.parse(s.decode(e));else v=e;if(v.asset===void 0||v.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let o=new V1(v,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){let a=this.pluginCallbacks[c](o);a.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),f[a.name]=a,r[a.name]=!0}if(v.extensionsUsed)for(let c=0;c<v.extensionsUsed.length;++c){let a=v.extensionsUsed[c],m=v.extensionsRequired||[];switch(a){case T.KHR_MATERIALS_UNLIT:r[a]=new v1;break;case T.KHR_DRACO_MESH_COMPRESSION:r[a]=new T1(v,this.dracoLoader);break;case T.KHR_TEXTURE_TRANSFORM:r[a]=new O1;break;case T.KHR_MESH_QUANTIZATION:r[a]=new A1;break;default:m.indexOf(a)>=0&&f[a]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+a+'".')}}o.setExtensions(r),o.setPlugins(f),o.parse(i,n)}parseAsync(e,t){let i=this;return new Promise(function(n,v){i.parse(e,t,n,v)})}};function g2(){let u={};return{get:function(e){return u[e]},add:function(e,t){u[e]=t},remove:function(e){delete u[e]},removeAll:function(){u={}}}}var T={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},n1=class{constructor(e){this.parser=e,this.name=T.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let i=0,n=t.length;i<n;i++){let v=t[i];v.extensions&&v.extensions[this.name]&&v.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,v.extensions[this.name].light)}}_loadLight(e){let t=this.parser,i="light:"+e,n=t.cache.get(i);if(n)return n;let v=t.json,s=((v.extensions&&v.extensions[this.name]||{}).lights||[])[e],o,c=new E(16777215);s.color!==void 0&&c.setRGB(s.color[0],s.color[1],s.color[2],D);let a=s.range!==void 0?s.range:0;switch(s.type){case"directional":o=new s0(c),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new K1(c),o.distance=a;break;case"spot":o=new z1(c),o.distance=a,s.spot=s.spot||{},s.spot.innerConeAngle=s.spot.innerConeAngle!==void 0?s.spot.innerConeAngle:0,s.spot.outerConeAngle=s.spot.outerConeAngle!==void 0?s.spot.outerConeAngle:Math.PI/4,o.angle=s.spot.outerConeAngle,o.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return o.position.set(0,0,0),o.decay=2,U(o,s),s.intensity!==void 0&&(o.intensity=s.intensity),o.name=t.createUniqueName(s.name||"light_"+e),n=Promise.resolve(o),t.cache.add(i,n),n}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,i=this.parser,v=i.json.nodes[e],f=(v.extensions&&v.extensions[this.name]||{}).light;return f===void 0?null:this._loadLight(f).then(function(s){return i._getNodeRef(t.cache,f,s)})}},v1=class{constructor(){this.name=T.KHR_MATERIALS_UNLIT}getMaterialType(){return $}extendParams(e,t,i){let n=[];e.color=new E(1,1,1),e.opacity=1;let v=t.pbrMetallicRoughness;if(v){if(Array.isArray(v.baseColorFactor)){let r=v.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],D),e.opacity=r[3]}v.baseColorTexture!==void 0&&n.push(i.assignTexture(e,"map",v.baseColorTexture,I))}return Promise.all(n)}},i1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=n.extensions[this.name].emissiveStrength;return v!==void 0&&(t.emissiveIntensity=v),Promise.resolve()}},r1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&v.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&v.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(v.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){let f=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Q(f,f)}return Promise.all(v)}},s1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&v.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&v.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(v)}},o1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_SHEEN}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[];t.sheenColor=new E(0,0,0),t.sheenRoughness=0,t.sheen=1;let r=n.extensions[this.name];if(r.sheenColorFactor!==void 0){let f=r.sheenColorFactor;t.sheenColor.setRGB(f[0],f[1],f[2],D)}return r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&v.push(i.assignTexture(t,"sheenColorMap",r.sheenColorTexture,I)),r.sheenRoughnessTexture!==void 0&&v.push(i.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(v)}},f1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&v.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(v)}},a1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_VOLUME}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&v.push(i.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;let f=r.attenuationColor||[1,1,1];return t.attenuationColor=new E().setRGB(f[0],f[1],f[2],D),Promise.all(v)}},c1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_IOR}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=n.extensions[this.name];return t.ior=v.ior!==void 0?v.ior:1.5,Promise.resolve()}},m1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_SPECULAR}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&v.push(i.assignTexture(t,"specularIntensityMap",r.specularTexture));let f=r.specularColorFactor||[1,1,1];return t.specularColor=new E().setRGB(f[0],f[1],f[2],D),r.specularColorTexture!==void 0&&v.push(i.assignTexture(t,"specularColorMap",r.specularColorTexture,I)),Promise.all(v)}},u1=class{constructor(e){this.parser=e,this.name=T.EXT_MATERIALS_BUMP}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return t.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&v.push(i.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(v)}},p1=class{constructor(e){this.parser=e,this.name=T.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:P}extendMaterialParams(e,t){let i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let v=[],r=n.extensions[this.name];return r.anisotropyStrength!==void 0&&(t.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(t.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&v.push(i.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(v)}},l1=class{constructor(e){this.parser=e,this.name=T.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,i=t.json,n=i.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let v=n.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,v.source,r)}},d1=class{constructor(e){this.parser=e,this.name=T.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,n=i.json,v=n.textures[e];if(!v.extensions||!v.extensions[t])return null;let r=v.extensions[t],f=n.images[r.source],s=i.textureLoader;if(f.uri){let o=i.options.manager.getHandler(f.uri);o!==null&&(s=o)}return this.detectSupport().then(function(o){if(o)return i.loadTextureImage(e,r.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},h1=class{constructor(e){this.parser=e,this.name=T.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,n=i.json,v=n.textures[e];if(!v.extensions||!v.extensions[t])return null;let r=v.extensions[t],f=n.images[r.source],s=i.textureLoader;if(f.uri){let o=i.options.manager.getHandler(f.uri);o!==null&&(s=o)}return this.detectSupport().then(function(o){if(o)return i.loadTextureImage(e,r.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},y1=class{constructor(e){this.name=T.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){let n=i.extensions[this.name],v=this.parser.getDependency("buffer",n.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return v.then(function(f){let s=n.byteOffset||0,o=n.byteLength||0,c=n.count,a=n.byteStride,m=new Uint8Array(f,s,o);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(c,a,m,n.mode,n.filter).then(function(p){return p.buffer}):r.ready.then(function(){let p=new ArrayBuffer(c*a);return r.decodeGltfBuffer(new Uint8Array(p),c,a,m,n.mode,n.filter),p})})}else return null}},b1=class{constructor(e){this.name=T.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;let n=t.meshes[i.mesh];for(let o of n.primitives)if(o.mode!==M.TRIANGLES&&o.mode!==M.TRIANGLE_STRIP&&o.mode!==M.TRIANGLE_FAN&&o.mode!==void 0)return null;let r=i.extensions[this.name].attributes,f=[],s={};for(let o in r)f.push(this.parser.getDependency("accessor",r[o]).then(c=>(s[o]=c,s[o])));return f.length<1?null:(f.push(this.parser.createNodeMesh(e)),Promise.all(f).then(o=>{let c=o.pop(),a=c.isGroup?c.children:[c],m=o[0].count,p=[];for(let l of a){let h=new c0,d=new V,y=new H0,b=new V(1,1,1),x=new k1(l.geometry,l.material,m);for(let _=0;_<m;_++)s.TRANSLATION&&d.fromBufferAttribute(s.TRANSLATION,_),s.ROTATION&&y.fromBufferAttribute(s.ROTATION,_),s.SCALE&&b.fromBufferAttribute(s.SCALE,_),x.setMatrixAt(_,h.compose(d,y,b));for(let _ in s)if(_==="_COLOR_0"){let R=s[_];x.instanceColor=new G0(R.array,R.itemSize,R.normalized)}else _!=="TRANSLATION"&&_!=="ROTATION"&&_!=="SCALE"&&l.geometry.setAttribute(_,s[_]);X0.prototype.copy.call(x,l),this.parser.assignFinalMaterial(x),p.push(x)}return c.isGroup?(c.clear(),c.add(...p),c):p[0]}))}},a2="glTF",p0=12,r2={JSON:1313821514,BIN:5130562},_1=class{constructor(e){this.name=T.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,p0),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==a2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let n=this.header.length-p0,v=new DataView(e,p0),r=0;for(;r<n;){let f=v.getUint32(r,!0);r+=4;let s=v.getUint32(r,!0);if(r+=4,s===r2.JSON){let o=new Uint8Array(e,p0+r,f);this.content=i.decode(o)}else if(s===r2.BIN){let o=p0+r;this.body=e.slice(o,o+f)}r+=f}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},T1=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=T.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let i=this.json,n=this.dracoLoader,v=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,f={},s={},o={};for(let c in r){let a=x1[c]||c.toLowerCase();f[a]=r[c]}for(let c in e.attributes){let a=x1[c]||c.toLowerCase();if(r[c]!==void 0){let m=i.accessors[e.attributes[c]],p=o0[m.componentType];o[a]=p.name,s[a]=m.normalized===!0}}return t.getDependency("bufferView",v).then(function(c){return new Promise(function(a,m){n.decodeDracoFile(c,function(p){for(let l in p.attributes){let h=p.attributes[l],d=s[l];d!==void 0&&(h.normalized=d)}a(p)},f,o,D,m)})})}},O1=class{constructor(){this.name=T.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},A1=class{constructor(){this.name=T.KHR_MESH_QUANTIZATION}},I0=class extends j1{constructor(e,t,i,n){super(e,t,i,n)}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,v=e*n*3+n;for(let r=0;r!==n;r++)t[r]=i[v+r];return t}interpolate_(e,t,i,n){let v=this.resultBuffer,r=this.sampleValues,f=this.valueSize,s=f*2,o=f*3,c=n-t,a=(i-t)/c,m=a*a,p=m*a,l=e*o,h=l-o,d=-2*p+3*m,y=p-m,b=1-d,x=y-m+a;for(let _=0;_!==f;_++){let R=r[h+_+f],A=r[h+_+s]*c,w=r[l+_+f],f0=r[l+_]*c;v[_]=b*R+x*A+d*w+y*f0}return v}},x2=new H0,g1=class extends I0{interpolate_(e,t,i,n){let v=super.interpolate_(e,t,i,n);return x2.fromArray(v).normalize().toArray(v),v}},M={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},o0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},s2={9728:J,9729:P0,9984:S1,9985:I1,9986:L1,9987:B0},o2={33071:E1,33648:R1,10497:L},$0={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},x1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},j={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},w2={CUBICSPLINE:void 0,LINEAR:W0,STEP:N1},e1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function V2(u){return u.DefaultMaterial===void 0&&(u.DefaultMaterial=new z0({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:y0})),u.DefaultMaterial}function q(u,e,t){for(let i in t.extensions)u[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function U(u,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(u.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function C2(u,e,t){let i=!1,n=!1,v=!1;for(let o=0,c=e.length;o<c;o++){let a=e[o];if(a.POSITION!==void 0&&(i=!0),a.NORMAL!==void 0&&(n=!0),a.COLOR_0!==void 0&&(v=!0),i&&n&&v)break}if(!i&&!n&&!v)return Promise.resolve(u);let r=[],f=[],s=[];for(let o=0,c=e.length;o<c;o++){let a=e[o];if(i){let m=a.POSITION!==void 0?t.getDependency("accessor",a.POSITION):u.attributes.position;r.push(m)}if(n){let m=a.NORMAL!==void 0?t.getDependency("accessor",a.NORMAL):u.attributes.normal;f.push(m)}if(v){let m=a.COLOR_0!==void 0?t.getDependency("accessor",a.COLOR_0):u.attributes.color;s.push(m)}}return Promise.all([Promise.all(r),Promise.all(f),Promise.all(s)]).then(function(o){let c=o[0],a=o[1],m=o[2];return i&&(u.morphAttributes.position=c),n&&(u.morphAttributes.normal=a),v&&(u.morphAttributes.color=m),u.morphTargetsRelative=!0,u})}function E2(u,e){if(u.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)u.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(u.morphTargetInfluences.length===t.length){u.morphTargetDictionary={};for(let i=0,n=t.length;i<n;i++)u.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function R2(u){let e,t=u.extensions&&u.extensions[T.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+t1(t.attributes):e=u.indices+":"+t1(u.attributes)+":"+u.mode,u.targets!==void 0)for(let i=0,n=u.targets.length;i<n;i++)e+=":"+t1(u.targets[i]);return e}function t1(u){let e="",t=Object.keys(u).sort();for(let i=0,n=t.length;i<n;i++)e+=t[i]+":"+u[t[i]]+";";return e}function w1(u){switch(u){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function S2(u){return u.search(/\.jpe?g($|\?)/i)>0||u.search(/^data\:image\/jpeg/)===0?"image/jpeg":u.search(/\.webp($|\?)/i)>0||u.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}var L2=new c0,V1=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new g2,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,n=!1,v=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,n=navigator.userAgent.indexOf("Firefox")>-1,v=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||n&&v<98?this.textureLoader=new H(this.options.manager):this.textureLoader=new q1(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new K(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let i=this,n=this.json,v=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(r){let f={scene:r[0][n.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:n.asset,parser:i,userData:{}};return q(v,f,n),U(f,n),Promise.all(i._invokeAll(function(s){return s.afterRoot&&s.afterRoot(f)})).then(function(){for(let s of f.scenes)s.updateMatrixWorld();e(f)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let n=0,v=t.length;n<v;n++){let r=t[n].joints;for(let f=0,s=r.length;f<s;f++)e[r[f]].isBone=!0}for(let n=0,v=e.length;n<v;n++){let r=e[n];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(i[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;let n=i.clone(),v=(r,f)=>{let s=this.associations.get(r);s!=null&&this.associations.set(f,s);for(let[o,c]of r.children.entries())v(c,f.children[o])};return v(i,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){let n=e(t[i]);if(n)return n}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let i=[];for(let n=0;n<t.length;n++){let v=e(t[n]);v&&i.push(v)}return i}getDependency(e,t){let i=e+":"+t,n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(v){return v.loadNode&&v.loadNode(t)});break;case"mesh":n=this._invokeOne(function(v){return v.loadMesh&&v.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(v){return v.loadBufferView&&v.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(v){return v.loadMaterial&&v.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(v){return v.loadTexture&&v.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(v){return v.loadAnimation&&v.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne(function(v){return v!=this&&v.getDependency&&v.getDependency(e,t)}),!n)throw new Error("Unknown type: "+e);break}this.cache.add(i,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){let i=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(v,r){return i.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[T.KHR_BINARY_GLTF].body);let n=this.options;return new Promise(function(v,r){i.load(X.resolveURL(t.uri,n.path),v,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){let n=t.byteLength||0,v=t.byteOffset||0;return i.slice(v,v+n)})}loadAccessor(e){let t=this,i=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0){let r=$0[n.type],f=o0[n.componentType],s=n.normalized===!0,o=new f(n.count*r);return Promise.resolve(new m0(o,r,s))}let v=[];return n.bufferView!==void 0?v.push(this.getDependency("bufferView",n.bufferView)):v.push(null),n.sparse!==void 0&&(v.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),v.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(v).then(function(r){let f=r[0],s=$0[n.type],o=o0[n.componentType],c=o.BYTES_PER_ELEMENT,a=c*s,m=n.byteOffset||0,p=n.bufferView!==void 0?i.bufferViews[n.bufferView].byteStride:void 0,l=n.normalized===!0,h,d;if(p&&p!==a){let y=Math.floor(m/p),b="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+y+":"+n.count,x=t.cache.get(b);x||(h=new o(f,y*p,n.count*p/c),x=new j0(h,p/c),t.cache.add(b,x)),d=new U0(x,s,m%p/c,l)}else f===null?h=new o(n.count*s):h=new o(f,m,n.count*s),d=new m0(h,s,l);if(n.sparse!==void 0){let y=$0.SCALAR,b=o0[n.sparse.indices.componentType],x=n.sparse.indices.byteOffset||0,_=n.sparse.values.byteOffset||0,R=new b(r[1],x,n.sparse.count*y),A=new o(r[2],_,n.sparse.count*s);f!==null&&(d=new m0(d.array.slice(),d.itemSize,d.normalized));for(let w=0,f0=R.length;w<f0;w++){let W=R[w];if(d.setX(W,A[w*s]),s>=2&&d.setY(W,A[w*s+1]),s>=3&&d.setZ(W,A[w*s+2]),s>=4&&d.setW(W,A[w*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d})}loadTexture(e){let t=this.json,i=this.options,v=t.textures[e].source,r=t.images[v],f=this.textureLoader;if(r.uri){let s=i.manager.getHandler(r.uri);s!==null&&(f=s)}return this.loadTextureImage(e,v,f)}loadTextureImage(e,t,i){let n=this,v=this.json,r=v.textures[e],f=v.images[t],s=(f.uri||f.bufferView)+":"+r.sampler;if(this.textureCache[s])return this.textureCache[s];let o=this.loadImageSource(t,i).then(function(c){c.flipY=!1,c.name=r.name||f.name||"",c.name===""&&typeof f.uri=="string"&&f.uri.startsWith("data:image/")===!1&&(c.name=f.uri);let m=(v.samplers||{})[r.sampler]||{};return c.magFilter=s2[m.magFilter]||P0,c.minFilter=s2[m.minFilter]||B0,c.wrapS=o2[m.wrapS]||L,c.wrapT=o2[m.wrapT]||L,n.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[s]=o,o}loadImageSource(e,t){let i=this,n=this.json,v=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(a=>a.clone());let r=n.images[e],f=self.URL||self.webkitURL,s=r.uri||"",o=!1;if(r.bufferView!==void 0)s=i.getDependency("bufferView",r.bufferView).then(function(a){o=!0;let m=new Blob([a],{type:r.mimeType});return s=f.createObjectURL(m),s});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let c=Promise.resolve(s).then(function(a){return new Promise(function(m,p){let l=m;t.isImageBitmapLoader===!0&&(l=function(h){let d=new k0(h);d.needsUpdate=!0,m(d)}),t.load(X.resolveURL(a,v.path),l,void 0,p)})}).then(function(a){return o===!0&&f.revokeObjectURL(s),a.userData.mimeType=r.mimeType||S2(r.uri),a}).catch(function(a){throw console.error("THREE.GLTFLoader: Couldn't load texture",s),a});return this.sourceCache[e]=c,c}assignTexture(e,t,i,n){let v=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(r=r.clone(),r.channel=i.texCoord),v.extensions[T.KHR_TEXTURE_TRANSFORM]){let f=i.extensions!==void 0?i.extensions[T.KHR_TEXTURE_TRANSFORM]:void 0;if(f){let s=v.associations.get(r);r=v.extensions[T.KHR_TEXTURE_TRANSFORM].extendTexture(r,f),v.associations.set(r,s)}}return n!==void 0&&(r.colorSpace=n),e[t]=r,r})}assignFinalMaterial(e){let t=e.geometry,i=e.material,n=t.attributes.tangent===void 0,v=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){let f="PointsMaterial:"+i.uuid,s=this.cache.get(f);s||(s=new z,G.prototype.copy.call(s,i),s.color.copy(i.color),s.map=i.map,s.sizeAttenuation=!1,this.cache.add(f,s)),i=s}else if(e.isLine){let f="LineBasicMaterial:"+i.uuid,s=this.cache.get(f);s||(s=new v0,G.prototype.copy.call(s,i),s.color.copy(i.color),s.map=i.map,this.cache.add(f,s)),i=s}if(n||v||r){let f="ClonedMaterial:"+i.uuid+":";n&&(f+="derivative-tangents:"),v&&(f+="vertex-colors:"),r&&(f+="flat-shading:");let s=this.cache.get(f);s||(s=i.clone(),v&&(s.vertexColors=!0),r&&(s.flatShading=!0),n&&(s.normalScale&&(s.normalScale.y*=-1),s.clearcoatNormalScale&&(s.clearcoatNormalScale.y*=-1)),this.cache.add(f,s),this.associations.set(s,this.associations.get(i))),i=s}e.material=i}getMaterialType(){return z0}loadMaterial(e){let t=this,i=this.json,n=this.extensions,v=i.materials[e],r,f={},s=v.extensions||{},o=[];if(s[T.KHR_MATERIALS_UNLIT]){let a=n[T.KHR_MATERIALS_UNLIT];r=a.getMaterialType(),o.push(a.extendParams(f,v,t))}else{let a=v.pbrMetallicRoughness||{};if(f.color=new E(1,1,1),f.opacity=1,Array.isArray(a.baseColorFactor)){let m=a.baseColorFactor;f.color.setRGB(m[0],m[1],m[2],D),f.opacity=m[3]}a.baseColorTexture!==void 0&&o.push(t.assignTexture(f,"map",a.baseColorTexture,I)),f.metalness=a.metallicFactor!==void 0?a.metallicFactor:1,f.roughness=a.roughnessFactor!==void 0?a.roughnessFactor:1,a.metallicRoughnessTexture!==void 0&&(o.push(t.assignTexture(f,"metalnessMap",a.metallicRoughnessTexture)),o.push(t.assignTexture(f,"roughnessMap",a.metallicRoughnessTexture))),r=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),o.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,f)})))}v.doubleSided===!0&&(f.side=Z);let c=v.alphaMode||e1.OPAQUE;if(c===e1.BLEND?(f.transparent=!0,f.depthWrite=!1):(f.transparent=!1,c===e1.MASK&&(f.alphaTest=v.alphaCutoff!==void 0?v.alphaCutoff:.5)),v.normalTexture!==void 0&&r!==$&&(o.push(t.assignTexture(f,"normalMap",v.normalTexture)),f.normalScale=new Q(1,1),v.normalTexture.scale!==void 0)){let a=v.normalTexture.scale;f.normalScale.set(a,a)}if(v.occlusionTexture!==void 0&&r!==$&&(o.push(t.assignTexture(f,"aoMap",v.occlusionTexture)),v.occlusionTexture.strength!==void 0&&(f.aoMapIntensity=v.occlusionTexture.strength)),v.emissiveFactor!==void 0&&r!==$){let a=v.emissiveFactor;f.emissive=new E().setRGB(a[0],a[1],a[2],D)}return v.emissiveTexture!==void 0&&r!==$&&o.push(t.assignTexture(f,"emissiveMap",v.emissiveTexture,I)),Promise.all(o).then(function(){let a=new r(f);return v.name&&(a.name=v.name),U(a,v),t.associations.set(a,{materials:e}),v.extensions&&q(n,a,v),a})}createUniqueName(e){let t=Y1.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,i=this.extensions,n=this.primitiveCache;function v(f){return i[T.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(f,t).then(function(s){return f2(s,f,t)})}let r=[];for(let f=0,s=e.length;f<s;f++){let o=e[f],c=R2(o),a=n[c];if(a)r.push(a.promise);else{let m;o.extensions&&o.extensions[T.KHR_DRACO_MESH_COMPRESSION]?m=v(o):m=f2(new e0,o,t),n[c]={primitive:o,promise:m},r.push(m)}}return Promise.all(r)}loadMesh(e){let t=this,i=this.json,n=this.extensions,v=i.meshes[e],r=v.primitives,f=[];for(let s=0,o=r.length;s<o;s++){let c=r[s].material===void 0?V2(this.cache):this.getDependency("material",r[s].material);f.push(c)}return f.push(t.loadGeometries(r)),Promise.all(f).then(function(s){let o=s.slice(0,s.length-1),c=s[s.length-1],a=[];for(let p=0,l=c.length;p<l;p++){let h=c[p],d=r[p],y,b=o[p];if(d.mode===M.TRIANGLES||d.mode===M.TRIANGLE_STRIP||d.mode===M.TRIANGLE_FAN||d.mode===void 0)y=v.isSkinnedMesh===!0?new B1(h,b):new B(h,b),y.isSkinnedMesh===!0&&y.normalizeSkinWeights(),d.mode===M.TRIANGLE_STRIP?y.geometry=Q0(y.geometry,b0):d.mode===M.TRIANGLE_FAN&&(y.geometry=Q0(y.geometry,a0));else if(d.mode===M.LINES)y=new u0(h,b);else if(d.mode===M.LINE_STRIP)y=new H1(h,b);else if(d.mode===M.LINE_LOOP)y=new X1(h,b);else if(d.mode===M.POINTS)y=new i0(h,b);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);Object.keys(y.geometry.morphAttributes).length>0&&E2(y,v),y.name=t.createUniqueName(v.name||"mesh_"+e),U(y,v),d.extensions&&q(n,y,d),t.assignFinalMaterial(y),a.push(y)}for(let p=0,l=a.length;p<l;p++)t.associations.set(a[p],{meshes:e,primitives:p});if(a.length===1)return v.extensions&&q(n,a[0],v),a[0];let m=new n0;v.extensions&&q(n,m,v),t.associations.set(m,{meshes:e});for(let p=0,l=a.length;p<l;p++)m.add(a[p]);return m})}loadCamera(e){let t,i=this.json.cameras[e],n=i[i.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new t0(_0.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):i.type==="orthographic"&&(t=new P1(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),U(t,i),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],i=[];for(let n=0,v=t.joints.length;n<v;n++)i.push(this._loadNodeShallow(t.joints[n]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(n){let v=n.pop(),r=n,f=[],s=[];for(let o=0,c=r.length;o<c;o++){let a=r[o];if(a){f.push(a);let m=new c0;v!==null&&m.fromArray(v.array,o*16),s.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new F1(f,s)})}loadAnimation(e){let t=this.json,i=this,n=t.animations[e],v=n.name?n.name:"animation_"+e,r=[],f=[],s=[],o=[],c=[];for(let a=0,m=n.channels.length;a<m;a++){let p=n.channels[a],l=n.samplers[p.sampler],h=p.target,d=h.node,y=n.parameters!==void 0?n.parameters[l.input]:l.input,b=n.parameters!==void 0?n.parameters[l.output]:l.output;h.node!==void 0&&(r.push(this.getDependency("node",d)),f.push(this.getDependency("accessor",y)),s.push(this.getDependency("accessor",b)),o.push(l),c.push(h))}return Promise.all([Promise.all(r),Promise.all(f),Promise.all(s),Promise.all(o),Promise.all(c)]).then(function(a){let m=a[0],p=a[1],l=a[2],h=a[3],d=a[4],y=[];for(let b=0,x=m.length;b<x;b++){let _=m[b],R=p[b],A=l[b],w=h[b],f0=d[b];if(_===void 0)continue;_.updateMatrix&&_.updateMatrix();let W=i._createAnimationTracks(_,R,A,w,f0);if(W)for(let N0=0;N0<W.length;N0++)y.push(W[N0])}return new U1(v,void 0,y)})}createNodeMesh(e){let t=this.json,i=this,n=t.nodes[e];return n.mesh===void 0?null:i.getDependency("mesh",n.mesh).then(function(v){let r=i._getNodeRef(i.meshCache,n.mesh,v);return n.weights!==void 0&&r.traverse(function(f){if(f.isMesh)for(let s=0,o=n.weights.length;s<o;s++)f.morphTargetInfluences[s]=n.weights[s]}),r})}loadNode(e){let t=this.json,i=this,n=t.nodes[e],v=i._loadNodeShallow(e),r=[],f=n.children||[];for(let o=0,c=f.length;o<c;o++)r.push(i.getDependency("node",f[o]));let s=n.skin===void 0?Promise.resolve(null):i.getDependency("skin",n.skin);return Promise.all([v,Promise.all(r),s]).then(function(o){let c=o[0],a=o[1],m=o[2];m!==null&&c.traverse(function(p){p.isSkinnedMesh&&p.bind(m,L2)});for(let p=0,l=a.length;p<l;p++)c.add(a[p]);return c})}_loadNodeShallow(e){let t=this.json,i=this.extensions,n=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let v=t.nodes[e],r=v.name?n.createUniqueName(v.name):"",f=[],s=n._invokeOne(function(o){return o.createNodeMesh&&o.createNodeMesh(e)});return s&&f.push(s),v.camera!==void 0&&f.push(n.getDependency("camera",v.camera).then(function(o){return n._getNodeRef(n.cameraCache,v.camera,o)})),n._invokeAll(function(o){return o.createNodeAttachment&&o.createNodeAttachment(e)}).forEach(function(o){f.push(o)}),this.nodeCache[e]=Promise.all(f).then(function(o){let c;if(v.isBone===!0?c=new W1:o.length>1?c=new n0:o.length===1?c=o[0]:c=new X0,c!==o[0])for(let a=0,m=o.length;a<m;a++)c.add(o[a]);if(v.name&&(c.userData.name=v.name,c.name=r),U(c,v),v.extensions&&q(i,c,v),v.matrix!==void 0){let a=new c0;a.fromArray(v.matrix),c.applyMatrix4(a)}else v.translation!==void 0&&c.position.fromArray(v.translation),v.rotation!==void 0&&c.quaternion.fromArray(v.rotation),v.scale!==void 0&&c.scale.fromArray(v.scale);return n.associations.has(c)||n.associations.set(c,{}),n.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){let t=this.extensions,i=this.json.scenes[e],n=this,v=new n0;i.name&&(v.name=n.createUniqueName(i.name)),U(v,i),i.extensions&&q(t,v,i);let r=i.nodes||[],f=[];for(let s=0,o=r.length;s<o;s++)f.push(n.getDependency("node",r[s]));return Promise.all(f).then(function(s){for(let c=0,a=s.length;c<a;c++)v.add(s[c]);let o=c=>{let a=new Map;for(let[m,p]of n.associations)(m instanceof G||m instanceof k0)&&a.set(m,p);return c.traverse(m=>{let p=n.associations.get(m);p!=null&&a.set(m,p)}),a};return n.associations=o(v),v})}_createAnimationTracks(e,t,i,n,v){let r=[],f=e.name?e.name:e.uuid,s=[];j[v.path]===j.weights?e.traverse(function(m){m.morphTargetInfluences&&s.push(m.name?m.name:m.uuid)}):s.push(f);let o;switch(j[v.path]){case j.weights:o=K0;break;case j.rotation:o=q0;break;case j.position:case j.scale:o=Y0;break;default:switch(i.itemSize){case 1:o=K0;break;case 2:case 3:default:o=Y0;break}break}let c=n.interpolation!==void 0?w2[n.interpolation]:W0,a=this._getArrayFromAccessor(i);for(let m=0,p=s.length;m<p;m++){let l=new o(s[m]+"."+j[v.path],t.array,a,c);n.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(l),r.push(l)}return r}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let i=w1(t.constructor),n=new Float32Array(t.length);for(let v=0,r=t.length;v<r;v++)n[v]=t[v]*i;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){let n=this instanceof q0?g1:I0;return new n(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function I2(u,e,t){let i=e.attributes,n=new T0;if(i.POSITION!==void 0){let f=t.json.accessors[i.POSITION],s=f.min,o=f.max;if(s!==void 0&&o!==void 0){if(n.set(new V(s[0],s[1],s[2]),new V(o[0],o[1],o[2])),f.normalized){let c=w1(o0[f.componentType]);n.min.multiplyScalar(c),n.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let v=e.targets;if(v!==void 0){let f=new V,s=new V;for(let o=0,c=v.length;o<c;o++){let a=v[o];if(a.POSITION!==void 0){let m=t.json.accessors[a.POSITION],p=m.min,l=m.max;if(p!==void 0&&l!==void 0){if(s.setX(Math.max(Math.abs(p[0]),Math.abs(l[0]))),s.setY(Math.max(Math.abs(p[1]),Math.abs(l[1]))),s.setZ(Math.max(Math.abs(p[2]),Math.abs(l[2]))),m.normalized){let h=w1(o0[m.componentType]);s.multiplyScalar(h)}f.max(s)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(f)}u.boundingBox=n;let r=new D1;n.getCenter(r.center),r.radius=n.min.distanceTo(n.max)/2,u.boundingSphere=r}function f2(u,e,t){let i=e.attributes,n=[];function v(r,f){return t.getDependency("accessor",r).then(function(s){u.setAttribute(f,s)})}for(let r in i){let f=x1[r]||r.toLowerCase();f in u.attributes||n.push(v(i[r],f))}if(e.indices!==void 0&&!u.index){let r=t.getDependency("accessor",e.indices).then(function(f){u.setIndex(f)});n.push(r)}return F0.workingColorSpace!==D&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${F0.workingColorSpace}" not supported.`),U(u,e),I2(u,e,t),Promise.all(n).then(function(){return e.targets!==void 0?C2(u,e.targets,t):u})}var c2="../../assets/gltf/scene-TUQFAHXQ.gltf";var m2=Y({name:"ThreeJsSmallCity",setup(){let u=l0(),e=d0(),t=new g0,i=new t0(45,3/2,.1,5e3),n=new s0(16777215,2.5),v=new x0(11657727,12155424,2);i.position.set(0,10,35),n.position.set(0,10,0),n.target.position.set(-5,0,0),n.castShadow=!0,h0(()=>{let o=new O0(40,40),c=new V0(i,u.value);new H().load(C0,p=>{p.colorSpace=I,p.wrapS=L,p.wrapT=L,p.magFilter=J,p.repeat.set(40/2,40/2);let l=new k({map:p,side:Z}),h=new B(o,l);h.rotation.x=-.5*Math.PI,h.receiveShadow=!0,t.add(h)}),new L0().load(c2,p=>{let l=p.scene;t.add(l);let h=new T0().setFromObject(l),d=h.getSize(new V).length(),y=h.getCenter(new V);f(d*.5,d,y,i),c.maxDistance=d*10,c.target.copy(y)}),e.value=new A0({antialias:!0,canvas:u.value}),e.value.shadowMap.enabled=!0,e.value.setPixelRatio(10),t.add(v,n),t.background=new E(0),c.target.set(0,5,0),c.update(),requestAnimationFrame(r)});let r=()=>{e.value.render(t,i),requestAnimationFrame(r)},f=(s,o,c,a)=>{let m=s*.5,p=_0.degToRad(a.fov*.5),l=m/Math.tan(p),h=new V().subVectors(a.position,c).multiply(new V(1,0,1)).normalize();a.position.copy(h.multiplyScalar(l).add(c)),a.near=o/100,a.far=o*100,a.updateProjectionMatrix(),a.lookAt(c.x,c.y,c.z)};return()=>C(S,null,C(w0,{showAnimation:!1},{canvas:()=>C("canvas",{class:i2("gl-canvas"),ref:u})}))}});function u2(u){let e=Object.assign({h1:"h1",code:"code",h2:"h2",ul:"ul",li:"li",p:"p"},D0(),u.components);return O.h(O.Fragment,null,O.h(e.h1,null,"\u4F7F\u7528",O.h(e.code,null,".obj"),"\u548C",O.h(e.code,null,".gltf"),"\u6587\u4EF6\u52A0\u8F7D",O.h(e.code,null,"3D"),"\u6A21\u578B"),`
`,O.h(e.h2,null,"\u4F7F\u7528",O.h(e.code,null,".obj"),"\u6587\u4EF6"),`
`,O.h(v2),`
`,O.h(e.h2,null,"\u4F7F\u7528",O.h(e.code,null,".gltf"),"\u6587\u4EF6"),`
`,O.h(e.ul,null,`
`,O.h(e.li,null,`
`,O.h(e.p,null,O.h(e.code,null,"gltf"),"\u683C\u5F0F\u7684\u4F18\u70B9\uFF1A"),`
`,O.h(e.ul,null,`
`,O.h(e.li,null,"\u4F53\u79EF\u5C0F\uFF0C\u9002\u5408\u7528\u4E8E\u4F20\u8F93"),`
`,O.h(e.li,null,"\u6613\u4E8E\u88AB\u6E32\u67D3"),`
`),`
`,O.h(m2),`
`),`
`))}function M2(u={}){let{wrapper:e}=Object.assign({},D0(),u.components);return e?O.h(e,u,O.h(u2,u)):u2(u)}var C1=M2;var D9=Y({name:"MDX_05-USE-OBJ-AND-GLTF",components:{MDXComponentContext:C1},setup(u,e){return()=>C("div",{class:"markdown-body",style:"padding: 15px;"},C(C1,{...e?.attrs}))}});export{D9 as default};
